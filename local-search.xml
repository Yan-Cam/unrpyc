<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>选择屏幕</title>
    <link href="/2023/07/29/SELECT_SCREEN/"/>
    <url>/2023/07/29/SELECT_SCREEN/</url>
    
    <content type="html"><![CDATA[<h1 id="选择屏幕"><a href="#选择屏幕" class="headerlink" title="选择屏幕"></a>选择屏幕</h1><blockquote><p>常常用来做报表程序，例如ALV程序中需要用户取数。</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730201805046.png" alt="选择屏幕界面"></p><h1 id="BlOCK"><a href="#BlOCK" class="headerlink" title="BlOCK"></a>BlOCK</h1><p>将控件放入块中，并设置一个文字标题</p><p>代码定义：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">SELECTION-SCREEN BEGIN OF BLOCK b1 WITH FRAME TITLE TEXT-001.<br>...<br>SELECTION-SCREEN END OF BLOCK b1.<br></code></pre></td></tr></table></figure><h1 id="LINE"><a href="#LINE" class="headerlink" title="LINE"></a>LINE</h1><p>将控件放入LINE中，排列方式将从默认的纵向改为横向</p><p>代码定义：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">SELECTION-SCREEN BEGIN OF LINE.<br>...<br>SELECTION-SCREEN END OF LINE.<br></code></pre></td></tr></table></figure><h1 id="常用控件"><a href="#常用控件" class="headerlink" title="常用控件"></a>常用控件</h1><h3 id="SELECT-OPTIONS（常用）"><a href="#SELECT-OPTIONS（常用）" class="headerlink" title="SELECT-OPTIONS（常用）"></a>SELECT-OPTIONS（常用）</h3><p>可以输入单值、多值 、范围</p><p>还可以使用包含、排除等条件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">SELECT-OPTIONS s_zsuid FOR gs_student-ZSUID NO-EXTENSION NO INTERVALS MODIF ID MD1.<br></code></pre></td></tr></table></figure><h3 id="PARAMETERS（不常用）"><a href="#PARAMETERS（不常用）" class="headerlink" title="PARAMETERS（不常用）"></a>PARAMETERS（不常用）</h3><p><strong>注：一般不会使用，因为使用后输入不能为空！！！</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">PARAMETERS p_mandt LIKE gs_student-MANDT MODIF ID MD1.<br></code></pre></td></tr></table></figure><h3 id="RADIOBUTTON"><a href="#RADIOBUTTON" class="headerlink" title="RADIOBUTTON"></a>RADIOBUTTON</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">SELECTION-SCREEN COMMENT (10) TEXT-001 FOR FIELD r_mode1.<br> PARAMETERS r_mode1 RADIOBUTTON GROUP gpm USER-COMMAND hide.<br> SELECTION-SCREEN COMMENT (10) TEXT-002 FOR FIELD r_mode2.<br> PARAMETERS r_mode2 RADIOBUTTON GROUP gpm.<br> SELECTION-SCREEN COMMENT (10) TEXT-003 FOR FIELD r_mode3.<br> PARAMETERS r_mode3 RADIOBUTTON GROUP gpm.<br></code></pre></td></tr></table></figure><h3 id="CHECKBOX"><a href="#CHECKBOX" class="headerlink" title="CHECKBOX"></a>CHECKBOX</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">PARAMETERS p_xxxx AS CHECKBOX.<br></code></pre></td></tr></table></figure><h3 id="DROP-DOWN-LIST"><a href="#DROP-DOWN-LIST" class="headerlink" title="DROP DOWN LIST"></a>DROP DOWN LIST</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">TYPE-POOLS: vrm.<br><br>DATA: gv_name TYPE vrm_id,<br>      gt_list TYPE vrm_values,<br>      gs_list LIKE LINE OF gt_list.<br><br>PARAMETERS: p_type(10) AS LISTBOX VISIBLE LENGTH 10.<br><br>AT SELECTION-SCREEN OUTPUT.<br><br>  gv_name = &#x27;P_TYPE&#x27;.<br>  gs_list-key = &#x27;1&#x27;.<br>  gs_list-text = &#x27;失败&#x27;.<br>  APPEND gs_list TO gt_list.<br><br>  gs_list-key = &#x27;2&#x27;.<br>  gs_list-text = &#x27;成功&#x27;.<br>  APPEND gs_list TO gt_list.<br><br>  gs_list-key = &#x27;3&#x27;.<br>  gs_list-text = &#x27;全部&#x27;.<br>  APPEND gs_list TO gt_list.<br><br>  CALL FUNCTION &#x27;VRM_SET_VALUES&#x27; EXPORTING id = gv_name values = gt_list.<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731014724123.png" alt="image-20230731014724123"></p><h1 id="常用后缀"><a href="#常用后缀" class="headerlink" title="常用后缀"></a>常用后缀</h1><p><code>NO-EXTENSION</code>：限制选择表为单行，后面不会出现扩展按钮（SELECT-OPTIONS）</p><p><code>NO INTERVALS</code>：会出现LOW字段，To后面的HIGH字段不出现在选择屏幕上，但是用户仍然可以在<strong>Mutiple Selection</strong>窗口中输入范围选择，也就是说如果没有设置NO-EXTENSION用户仍然可以输入非单行（SELECT-OPTIONS）</p><p><code>MODIF ID</code>：分组标识（ALL）</p><p><code>OBLIGATORY</code>：标识参数为必输项，只有前面一个框框中出现扩展按钮，第二个框没有，也就是说该选项只能LOW字段有效</p><p><code>DEFAULT</code>：使用后缀为参数指定缺省值</p><h1 id="文本元素"><a href="#文本元素" class="headerlink" title="文本元素"></a>文本元素</h1><blockquote><p>设置控件文本，或者块标题</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730204717066.png" alt="文本元素步骤一"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730204757156.png" alt="文本符号"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730204901310.png" alt="选择文本"></p><h1 id="PBO与PAI-生命周期？"><a href="#PBO与PAI-生命周期？" class="headerlink" title="PBO与PAI(生命周期？)"></a>PBO与PAI(生命周期？)</h1><blockquote><p>PBO（Process Before Output）：就是在屏幕输出之前做的一些操作，例如：控制按钮的显示和键值、屏幕初始化的操作等</p></blockquote><blockquote><p>PAI（Process After Input）：就是在屏幕已经展示出来，在屏幕上做的操作,会触发PAI，例如：点击按钮触发的事件可以在PAI中去定义。</p></blockquote><p>PBO与PAI与屏幕的生命周期：</p><p>PBO -&gt; 屏幕 -&gt; PAI -&gt; （另一屏幕的）PBO -&gt; 另一屏幕 -&gt; PAI （另一屏幕的）-&gt; PBO（另一屏幕的）… … </p><h1 id="选择屏幕的生命周期"><a href="#选择屏幕的生命周期" class="headerlink" title="选择屏幕的生命周期"></a>选择屏幕的生命周期</h1><p>INITIALIZATION -&gt; START-OF-SELECTION -&gt; AT SELECTION-SCREEN -&gt; END-OF-SELECTION -&gt; AT SELECTION-SCREEN</p><p><code>INITIALIZATION</code>：初始化</p><p>进行一些非选择屏幕空间数据的初始化，例如给选择屏幕添加一个功能按钮：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">functxt-icon_id = ICON_INTENSIFY.<br>functxt-icon_text = &#x27;维护学生信息表&#x27;.<br>sscrfields-functxt_01 = functxt.<br></code></pre></td></tr></table></figure><p><code>START-OF-SELECTION</code>：取数逻辑</p><p>取数逻辑例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">FORM get_data .<br> CLEAR gt_student.<br> SELECT zsuid,mandt,zsname,zschool,zsage,zssex<br>    FROM ztyc001<br>    INTO CORRESPONDING FIELDS OF TABLE @gt_student<br>    WHERE zsuid IN @s_zsuid<br>    AND zsname IN @s_zsname<br>    AND zschool IN @s_school<br> AND zsage IN @s_zsage<br> AND zssex = @r_sex.<br>ENDFORM.<br></code></pre></td></tr></table></figure><p><code>AT SELECTION-SCREEN</code>：屏幕事件</p><p>（1）.其实就像一个FORM，所以在这个事件里声明的变量都是局部变量。</p><p>（2）.根据SY-UCOMM这个系统变量可以判断用户的命令</p><p>（3）.在这个事件里响应的是屏幕上选择条件中的事件，例如CHECKBOX的选择与否，RADIOBUTTON的选择，LISTBOX的选择等等。</p><p>所以分为以下几个方面：</p><ol><li>… ON field ：在PARAMETER变化时触发的事件，对于选择屏幕某字段输入的PAI事件，当该字段的值被传递给程序时被触发，可以应用于改字段本身的正确性检查，如可系统提示错误，则可以在该字段中重新输入，此时其他元素呈灰色，不接受输入</li><li>… ON END OF sel ：SELECT-OPTION触发的事件,用于整个选择表输入结束后各行的检查</li><li>… ON VALUE-REQUEST FOR psel_low_high ：当光标位于某屏幕字段时，选择的帮助(F4)</li><li>… ON HELP-REQUEST FOR psel_low_high ：当光标位于某屏幕字段时，选择的帮助(F1)</li><li>… ON RADIOBUTTON GROUP radi ：单选按钮事件，必须进行整体输入检查</li><li>… ON BLOCK block ：框架的触发事件</li><li>… OUTPUT ：响应屏幕上的事件，修改选择屏幕的唯一方法</li></ol><p>在上面定义了一个功能按钮，如果要做监听就可以在此处通过SY-UCOMM判断：</p><p><strong>注：FC01表示添加的第一个按钮，依次类推<code>FC02</code>表示第二个，<code>FC03</code>表示……</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">IF sscrfields-ucomm = &#x27;FC01&#x27;.<br> PERFORM FRM_CALL_SM30 USING &#x27;ZTYC001&#x27;.<br>ENDIF.<br></code></pre></td></tr></table></figure><p><code>AT SELECTION-SCREEN OUTPUT</code>：PBO事件</p><p><code>END-OF-SELECTION</code>：显示数据</p><h1 id="动态显示"><a href="#动态显示" class="headerlink" title="动态显示"></a>动态显示</h1><p><strong>特别提醒：如果需要做动态显示，那么被切换的控件里一定不能有默认数据，如<code>SELECT-OPTION</code>里面有默认数据，会导致无法切换。（是否有解决办法呢？）</strong></p><p>顾名思义，就是将控件分成不同组别，进行动态切换显示的效果，依靠<code>MODIF ID</code>后缀实现。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">*&amp;---------------------------------------------------------------------*<br> *&amp; 包含        ZYC_T002FORM<br> *&amp;---------------------------------------------------------------------*<br> SELECTION-SCREEN BEGIN OF BLOCK b1 WITH FRAME TITLE TEXT-001.<br>  SELECT-OPTIONS s_zsuid FOR gs_student-ZSUID NO-EXTENSION NO INTERVALS MODIF ID MD1.<br>  PARAMETERS p_mandt LIKE gs_student-MANDT MODIF ID MD1.<br>  SELECT-OPTIONS s_zsname FOR gs_student-ZSNAME NO-EXTENSION NO INTERVALS MODIF ID MD1.<br>  SELECT-OPTIONS s_school FOR gs_student-ZSCHOOL NO-EXTENSION NO INTERVALS MODIF ID MD1.<br> SELECTION-SCREEN END OF BLOCK b1.<br><br> SELECTION-SCREEN BEGIN OF BLOCK b2 WITH FRAME TITLE TEXT-002.<br>  SELECT-OPTIONS s_zsage FOR gs_student-ZSAGE DEFAULT 1 to 10 MODIF ID MD2. .<br> SELECTION-SCREEN END OF BLOCK b2.<br><br> SELECTION-SCREEN BEGIN OF BLOCK b3 WITH FRAME TITLE TEXT-003.<br>PARAMETERS r_male RADIOBUTTON GROUP gps USER-COMMAND set MODIF ID MD3.<br>PARAMETERS r_female RADIOBUTTON GROUP gps MODIF ID MD3.<br><br> SELECTION-SCREEN END OF BLOCK b3.<br><br> SELECTION-SCREEN BEGIN OF BLOCK b4 WITH FRAME TITLE TEXT-004.<br>   SELECTION-SCREEN BEGIN OF LINE.<br>   SELECTION-SCREEN COMMENT (10) TEXT-001 FOR FIELD r_mode1.<br>    PARAMETERS r_mode1 RADIOBUTTON GROUP gpm USER-COMMAND hide.<br>    SELECTION-SCREEN COMMENT (10) TEXT-002 FOR FIELD r_mode2.<br>    PARAMETERS r_mode2 RADIOBUTTON GROUP gpm.<br>    SELECTION-SCREEN COMMENT (10) TEXT-003 FOR FIELD r_mode3.<br>    PARAMETERS r_mode3 RADIOBUTTON GROUP gpm.<br>  SELECTION-SCREEN END OF LINE.<br> SELECTION-SCREEN END OF BLOCK b4.<br><br> SELECTION-SCREEN FUNCTION KEY 1.<br></code></pre></td></tr></table></figure><p>由此上代码可以看出，屏幕控件被分为了三组，分别为MD1、MD2、MD3</p><p>在第四块中将需要触发动态屏幕的RADIOBUTTON后面定义USER-COMMAND组，来实现指令，换种说法，也就是让SAP知道点击这里需要触发事件。</p><p>在 AT SELECTION-SCREEN OUTPUT下面写具体的需要控制的条件，也就是在PBO中便利屏幕元素并控制其显示或隐藏，当在第四块中点击RADIOBUTTON，屏幕会刷新，也会从新执行PBO事件，所以选择屏幕上的控件也会发生变化。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">AT SELECTION-SCREEN OUTPUT.<br>PERFORM pbo.<br>  <br> FORM pbo .<br>  LOOP AT SCREEN.<br>   IF r_male = &#x27;X&#x27;.<br>    r_sex = &#x27;M&#x27;.<br>   ENDIF.<br>   IF r_female = &#x27;X&#x27;.<br>    r_sex = &#x27;F&#x27;.<br>   ENDIF.<br>   IF r_mode1 = &#x27;X&#x27;.<br>   ELSE.<br>    IF screen-group1 = &#x27;MD1&#x27;.<br>     screen-active = &#x27;0&#x27;.<br>     MODIFY SCREEN.<br>    ENDIF.<br>   ENDIF.<br><br>   IF r_mode2 = &#x27;X&#x27;.<br>   ELSE.<br>    IF screen-group1 = &#x27;MD2&#x27;.<br>     screen-active = &#x27;0&#x27;.<br>     MODIFY SCREEN.<br>    ENDIF.<br>   ENDIF.<br><br>   IF r_mode3 = &#x27;X&#x27;.<br>   ELSE.<br>    IF screen-group1 = &#x27;MD3&#x27;.<br>     screen-active = &#x27;0&#x27;.<br>     MODIFY SCREEN.<br>    ENDIF.<br>   ENDIF.<br>  ENDLOOP.<br> ENDFORM.<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730203451409.png" alt="动态切换1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730203653808.png" alt="动态切换2"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730203758924.png" alt="动态切换3"></p><h1 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h1><p>ZYC_T002：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">*[&amp;---------------------------------------------------------------------*<br> *&amp; Report ZYC_T002<br> *&amp;---------------------------------------------------------------------*<br> *&amp;<br> *&amp;---------------------------------------------------------------------*<br> REPORT zyc_t002 NO STANDARD PAGE HEADING.<br> INCLUDE zyc_t002top.<br> INCLUDE zyc_t002form.<br><br> INITIALIZATION.<br>  r_mode1 = &#x27;X&#x27;.<br>  r_male = &#x27;X&#x27;.<br>  r_sex = &#x27;M&#x27;.<br>  functxt-icon_id = ICON_INTENSIFY.<br>  functxt-icon_text = &#x27;维护学生信息表&#x27;.<br>  sscrfields-functxt_01 = functxt.<br><br> START-OF-SELECTION.<br>  PERFORM get_data.<br><br> AT SELECTION-SCREEN.<br>  IF sscrfields-ucomm = &#x27;FC01&#x27;.<br>   PERFORM FRM_CALL_SM30 USING &#x27;ZTYC001&#x27;.<br>  ENDIF.<br><br> END-OF-SELECTION.<br>  PERFORM display_data.<br><br> AT SELECTION-SCREEN OUTPUT.<br>  PERFORM pbo.<br> *&amp;---------------------------------------------------------------------*<br> *&amp; Form GET_DATA<br> *&amp;---------------------------------------------------------------------*<br> *&amp; text<br> *&amp;---------------------------------------------------------------------*<br> *&amp; --&gt; p1    text<br> *&amp; &lt;-- p2    text<br> *&amp;---------------------------------------------------------------------*<br> FORM get_data .<br>  CLEAR gt_student.<br>  SELECT zsuid,mandt,zsname,zschool,zsage,zssex<br>     FROM ztyc001<br>     INTO CORRESPONDING FIELDS OF TABLE @gt_student<br>     WHERE zsuid IN @s_zsuid<br>     AND zsname IN @s_zsname<br>     AND zschool IN @s_school<br>  AND zsage IN @s_zsage<br>  AND zssex = @r_sex.<br> ENDFORM.<br> *&amp;---------------------------------------------------------------------*<br> *&amp; Form display_data<br> *&amp;---------------------------------------------------------------------*<br> *&amp; text<br> *&amp;---------------------------------------------------------------------*<br> *&amp; --&gt; p1    text<br> *&amp; &lt;-- p2    text<br> *&amp;---------------------------------------------------------------------*<br> FORM display_data .<br>  IF gt_student IS NOT INITIAL.<br>   CLEAR gs_student.<br>   WRITE: /1(55) sy-uline .<br>   WRITE:/1 sy-vline NO-GAP,(10) &#x27;学号&#x27; NO-GAP CENTERED,<br>        sy-vline NO-GAP,(10) &#x27;性别&#x27; NO-GAP CENTERED,<br>        sy-vline NO-GAP,(10) &#x27;年龄&#x27; NO-GAP CENTERED,<br>        sy-vline NO-GAP,(10) &#x27;姓名&#x27; NO-GAP CENTERED,<br>        sy-vline NO-GAP,(10) &#x27;学校代码&#x27; NO-GAP CENTERED,<br>        sy-vline NO-GAP.<br>   WRITE: /1(55) sy-uline .<br>   LOOP AT gt_student INTO gs_student.<br>    WRITE:/1 sy-vline NO-GAP,(10) gs_student-zsuid NO-GAP CENTERED,<br>         sy-vline NO-GAP,(10) gs_student-zssex NO-GAP CENTERED,<br>         sy-vline NO-GAP,(10) gs_student-zsage NO-GAP CENTERED,<br>         sy-vline NO-GAP,(10) gs_student-zsname NO-GAP CENTERED,<br>         sy-vline NO-GAP,(10) gs_student-zschool NO-GAP CENTERED,<br>         sy-vline NO-GAP..<br>    CLEAR gs_student.<br>    WRITE: /1(55) sy-uline.<br>   ENDLOOP.<br>  ELSE.<br>   WRITE &#x27;暂无数据&#x27;.<br>  ENDIF.<br> ENDFORM.<br> *&amp;---------------------------------------------------------------------*<br> *&amp; Form pbo<br> *&amp;---------------------------------------------------------------------*<br> *&amp; text<br> *&amp;---------------------------------------------------------------------*<br> *&amp; --&gt; p1    text<br> *&amp; &lt;-- p2    text<br> *&amp;---------------------------------------------------------------------*<br> FORM pbo .<br>  LOOP AT SCREEN.<br>   IF r_male = &#x27;X&#x27;.<br>    r_sex = &#x27;M&#x27;.<br>   ENDIF.<br>   IF r_female = &#x27;X&#x27;.<br>    r_sex = &#x27;F&#x27;.<br>   ENDIF.<br>   IF r_mode1 = &#x27;X&#x27;.<br>   ELSE.<br>    IF screen-group1 = &#x27;MD1&#x27;.<br>     screen-active = &#x27;0&#x27;.<br>     MODIFY SCREEN.<br>    ENDIF.<br>   ENDIF.<br><br>   IF r_mode2 = &#x27;X&#x27;.<br>   ELSE.<br>    IF screen-group1 = &#x27;MD2&#x27;.<br>     screen-active = &#x27;0&#x27;.<br>     MODIFY SCREEN.<br>    ENDIF.<br>   ENDIF.<br><br>   IF r_mode3 = &#x27;X&#x27;.<br>   ELSE.<br>    IF screen-group1 = &#x27;MD3&#x27;.<br>     screen-active = &#x27;0&#x27;.<br>     MODIFY SCREEN.<br>    ENDIF.<br>   ENDIF.<br>  ENDLOOP.<br> ENDFORM.<br><br> *&amp;---------------------------------------------------------------------*<br> *&amp; Form frm_call_sm30<br> *&amp;---------------------------------------------------------------------*<br> *&amp; text<br> *&amp;---------------------------------------------------------------------*<br> *&amp;   --&gt; P_<br> *&amp;   --&gt; WHEN<br> *&amp;   --&gt; P_<br> *&amp;---------------------------------------------------------------------*<br> FORM frm_call_sm30 USING p_name TYPE dd02v-tabname.<br><br>  CALL FUNCTION &#x27;VIEW_MAINTENANCE_CALL&#x27;<br>   EXPORTING<br>    action            = &#x27;U&#x27;<br>    view_name          = p_name<br>    no_warning_for_clientindep  = &#x27;X&#x27;<br>   EXCEPTIONS<br>    client_reference       = 1<br>    foreign_lock         = 2<br>    invalid_action        = 3<br>    no_clientindependent_auth  = 4<br>    no_database_function     = 5<br>    no_editor_function      = 6<br>    no_show_auth         = 7<br>    no_tvdir_entry        = 8<br>    no_upd_auth         = 9<br>    only_show_allowed      = 10<br>    system_failure        = 11<br>    unknown_field_in_dba_sellist = 12<br>    view_not_found        = 13<br>    OTHERS            = 14.<br> ENDFORM.<br></code></pre></td></tr></table></figure><p>zyc_t002top：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">TYPES gty_student TYPE STANDARD TABLE OF ZTYC001.<br> TABLES: /SCWM/AQUA,SSCRFIELDS.<br> DATA: gt_student TYPE gty_student,<br>    gs_student LIKE LINE OF gt_student,<br>    r_sex LIKE gs_student-ZSSEX,<br>    functxt TYPE SMP_DYNTXT.<br></code></pre></td></tr></table></figure><p>zyc_t002form：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">*&amp;---------------------------------------------------------------------*<br> *&amp; 包含        ZYC_T002FORM<br> *&amp;---------------------------------------------------------------------*<br> SELECTION-SCREEN BEGIN OF BLOCK b1 WITH FRAME TITLE TEXT-001.<br>  SELECT-OPTIONS s_zsuid FOR gs_student-ZSUID NO-EXTENSION NO INTERVALS MODIF ID MD1.<br>  PARAMETERS p_mandt LIKE gs_student-MANDT MODIF ID MD1.<br>  SELECT-OPTIONS s_zsname FOR gs_student-ZSNAME NO-EXTENSION NO INTERVALS MODIF ID MD1.<br>  SELECT-OPTIONS s_school FOR gs_student-ZSCHOOL NO-EXTENSION NO INTERVALS MODIF ID MD1.<br> SELECTION-SCREEN END OF BLOCK b1.<br><br> SELECTION-SCREEN BEGIN OF BLOCK b2 WITH FRAME TITLE TEXT-002.<br>  SELECT-OPTIONS s_zsage FOR gs_student-ZSAGE DEFAULT 1 to 10 MODIF ID MD2. .<br> SELECTION-SCREEN END OF BLOCK b2.<br><br> SELECTION-SCREEN BEGIN OF BLOCK b3 WITH FRAME TITLE TEXT-003.<br>PARAMETERS r_male RADIOBUTTON GROUP gps USER-COMMAND set MODIF ID MD3.<br>PARAMETERS r_female RADIOBUTTON GROUP gps MODIF ID MD3.<br><br> SELECTION-SCREEN END OF BLOCK b3.<br><br> SELECTION-SCREEN BEGIN OF BLOCK b4 WITH FRAME TITLE TEXT-004.<br>   SELECTION-SCREEN BEGIN OF LINE.<br>   SELECTION-SCREEN COMMENT (10) TEXT-001 FOR FIELD r_mode1.<br>    PARAMETERS r_mode1 RADIOBUTTON GROUP gpm USER-COMMAND hide.<br>    SELECTION-SCREEN COMMENT (10) TEXT-002 FOR FIELD r_mode2.<br>    PARAMETERS r_mode2 RADIOBUTTON GROUP gpm.<br>    SELECTION-SCREEN COMMENT (10) TEXT-003 FOR FIELD r_mode3.<br>    PARAMETERS r_mode3 RADIOBUTTON GROUP gpm.<br>  SELECTION-SCREEN END OF LINE.<br> SELECTION-SCREEN END OF BLOCK b4.<br><br> SELECTION-SCREEN FUNCTION KEY 1.<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ABAP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SAP</tag>
      
      <tag>ABAP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SMARTFORMS</title>
    <link href="/2023/07/29/SMARTFORMS/"/>
    <url>/2023/07/29/SMARTFORMS/</url>
    
    <content type="html"><![CDATA[<h1 id="SMARTFORMS"><a href="#SMARTFORMS" class="headerlink" title="SMARTFORMS"></a>SMARTFORMS</h1><blockquote><p>SAP所提供的一款功能强大的商务报表解决方案，也被称为智能表单</p></blockquote><h2 id="Smart-Forms基本概念"><a href="#Smart-Forms基本概念" class="headerlink" title="Smart Forms基本概念"></a>Smart Forms基本概念</h2><p>能够按指定格式生成报表，并可以将执行结果通过连接打印机直接输出</p><p>采用图形模式来控制报表的格式及位置</p><p>基本事务代码：</p><ul><li>SMARTFORMS：维护表单</li><li>SMARTSTYLES：维护格式</li></ul><p>Smart Forms原理：</p><p>定义内表后，在程序中通过SQL查询将需要的数据放入内表，然后通过函数调用SMARTFORM。在执行SMARTFORM时把内表中的数据填充到所画的表格当中，并显示出来。</p><h2 id="Smart-Forms界面使用方法"><a href="#Smart-Forms界面使用方法" class="headerlink" title="Smart Forms界面使用方法"></a>Smart Forms界面使用方法</h2><h3 id="事务代码：SMARTFORMS"><a href="#事务代码：SMARTFORMS" class="headerlink" title="事务代码：SMARTFORMS"></a>事务代码：SMARTFORMS</h3><p>文本</p><ul><li>创建Smartforms 及相关对象属性设置</li></ul><p>样式</p><ul><li>指定FORM中的文本属性</li><li>字体&#x2F;颜色&#x2F;大小等</li></ul><p>文本模块</p><ul><li>很多对象、文本、消息、提示内容都可以预先设定，可以复用的文本模块多在此设定</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731193837505.png" alt="SMARTFORMS界面"></p><h3 id="SAP-Form-Builder"><a href="#SAP-Form-Builder" class="headerlink" title="SAP Form Builder"></a>SAP Form Builder</h3><h4 id="Navigation-Menu"><a href="#Navigation-Menu" class="headerlink" title="Navigation Menu"></a>Navigation Menu</h4><p>Smart Form开发的Form element、节点、在此显示，在窗口左边显示</p><h4 id="Maintenance-Frame"><a href="#Maintenance-Frame" class="headerlink" title="Maintenance Frame"></a>Maintenance Frame</h4><p>选择的节点属性在此设定，在窗口的中间部分显示</p><h4 id="Form-Painter"><a href="#Form-Painter" class="headerlink" title="Form Painter"></a>Form Painter</h4><p>按钮出现form Painter,在窗口的最右边，显示windows和graphics的位置，大小，布局</p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731194155982.png" alt="Builder界面"></p><table><thead><tr><th><strong>元素</strong></th><th><strong>中文</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td>Page</td><td>页面</td><td>不同的页面允许维护不同的格式</td></tr><tr><td>Window</td><td>窗体</td><td>包括主窗体和子窗体，后续节点包括Window和Page以外的所有节点</td></tr><tr><td>Graphic</td><td>图形</td><td>输出页面中的图片</td></tr><tr><td>Address</td><td>地址</td><td>包含数据库中的标准地址</td></tr><tr><td>Template</td><td>模板</td><td>输出包含静态数据的表格（固定行列）</td></tr><tr><td>Table</td><td>表</td><td>输出包含应用数据的表格（可自动扩展）</td></tr><tr><td>Alternative</td><td>是非判断</td><td>执行判断，根据判断结果是非执行两个分支</td></tr><tr><td>Program Lines</td><td>程序代码</td><td>指定传入传出参数，执行ABAP代码</td></tr><tr><td>Loop</td><td>循环</td><td>反复执行后续节点</td></tr><tr><td>Text</td><td>文本</td><td>输出文本&#x2F;变量&#x2F;文本模块</td></tr><tr><td>Command</td><td>命令</td><td>命令操作（如分页）</td></tr><tr><td>Folder</td><td>文件夹</td><td>将多个后续节点组合为一个组</td></tr></tbody></table><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731194928184.png" alt="图标对应功能参考"></p><h3 id="所有的Form-Global-Setting节点和Pages-and-window在这显示。"><a href="#所有的Form-Global-Setting节点和Pages-and-window在这显示。" class="headerlink" title="所有的Form Global Setting节点和Pages and window在这显示。"></a>所有的Form Global Setting节点和Pages and window在这显示。</h3><ul><li>Global Settings 全局设定</li><li>Form attributes : 基本信息和格式设定</li></ul><h3 id="设置页面样式，指定输出样式（Smartstyles下面创建的样式）"><a href="#设置页面样式，指定输出样式（Smartstyles下面创建的样式）" class="headerlink" title="设置页面样式，指定输出样式（Smartstyles下面创建的样式）"></a>设置页面样式，指定输出样式（Smartstyles下面创建的样式）</h3><ul><li>Form interface : 输入输出参数。在此设定与调用程序间传的参数</li><li>Global definitions : Smart Forms中内部使用的私有变量，不与外界交互.</li></ul><h3 id="Pages-and-windows"><a href="#Pages-and-windows" class="headerlink" title="Pages and windows"></a>Pages and windows</h3><ul><li>显示数据和设定Page页面和windows窗口布局</li></ul><h3 id="执行流程"><a href="#执行流程" class="headerlink" title="执行流程"></a>执行流程</h3><ul><li>根据元素的清单，自上而下的执行</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731194517321.png" alt="示例图片"></p><h3 id="数据定义"><a href="#数据定义" class="headerlink" title="数据定义"></a>数据定义</h3><h4 id="Form-Interface"><a href="#Form-Interface" class="headerlink" title="Form Interface"></a>Form Interface</h4><ul><li>用于数据传输，导入&#x2F;导出参数，表格传输，异常</li><li>结构及表需要参照数据字典中定义的结构&#x2F;表类型进行定义</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731194759684.png" alt="Form Interface"></p><h4 id="Global-Definition"><a href="#Global-Definition" class="headerlink" title="Global Definition"></a>Global Definition</h4><ul><li>定义Smartforms内部使用变量</li><li>设置类型、字段符号（动态指定变量）、初始化等设置</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731194825419.png" alt="Global Definition"></p><h3 id="页面（PAGE）"><a href="#页面（PAGE）" class="headerlink" title="页面（PAGE）"></a>页面（PAGE）</h3><blockquote><p>Smartforms允许建立多个页面，而且不同的页面允许维护不同的格式</p></blockquote><p>例如封面&#x2F;正文</p><p>可包含节点：</p><p>窗体</p><ul><li>包括主窗体和子窗体</li><li>后续节点包括除Window和Page外所有节点</li></ul><p>图形</p><ul><li>输出页面中的图片</li></ul><p>地址</p><ul><li>包含数据库中的标准地址</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731200614808.png" alt="页面1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731200651652.png" alt="页面2"></p><h3 id="窗体（WINDOWW）"><a href="#窗体（WINDOWW）" class="headerlink" title="窗体（WINDOWW）"></a>窗体（WINDOWW）</h3><blockquote><p>作为容器，放置显示用元素（元素累计宽高不能超过窗体宽度高度）</p></blockquote><p>Smartforms中一般是通过多个窗体来存放不同的内容。</p><p>动态数据主要存储在主窗体中</p><ul><li>主窗体在所有页面中是一致的</li><li>一个页面中至少包含且只能包含一个主窗体</li></ul><p>其他数据通过子窗体来实现</p><ul><li>一个页面中可以包含多个子窗体</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731200846893.png" alt="窗体1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731200900790.png" alt="窗体2"></p><h3 id="图片（Graphic）"><a href="#图片（Graphic）" class="headerlink" title="图片（Graphic）"></a>图片（Graphic）</h3><blockquote><p>Smartforms所制作的报表中，通常需要加入一些特定的图像，如公司的Logo、商标等。此时使用图片组件，可以加入系统中存在的图片</p></blockquote><ul><li>选择要插入的图片，黑白&#x2F;彩色设置</li></ul><h4 id="向系统中增加图片（SE78）"><a href="#向系统中增加图片（SE78）" class="headerlink" title="向系统中增加图片（SE78）"></a>向系统中增加图片（SE78）</h4><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731201109323.png" alt="插入图片步骤1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731201616930.png" alt="插入图片步骤1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731201701730.png" alt="插入图片步骤3"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731201824116.png" alt="插入图片步骤4"></p><h3 id="地址（Address）"><a href="#地址（Address）" class="headerlink" title="地址（Address）"></a>地址（Address）</h3><blockquote><p>引用数据库中已经定义过的地址，显示在界面指定位置</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731202044186.png" alt="地址1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731202100630.png" alt="地址2"></p><h3 id="模板（Template）"><a href="#模板（Template）" class="headerlink" title="模板（Template）"></a>模板（Template）</h3><blockquote><p>用于实现输出数值的定位，进行固定行列的表格输出</p></blockquote><ul><li>在绘图的界面中通过拖拽，使用画笔直接增加行&#x2F;列</li><li>点击细节，可以对每行&#x2F;列进行宽高。</li></ul><p><strong>注意：</strong></p><ul><li><strong>分行的总宽度不能超过表的宽度</strong></li><li><strong>分列的总高度不能超过表的高度</strong></li><li><strong>在模板中增加文本时，注意要指定对应的行&#x2F;列</strong></li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731202248821.png" alt="模板初步设计"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731202418231.png" alt="边框模式设计"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731202435305.png" alt="细节调整（点击第一张图的details）"></p><h3 id="表（Table）-设置好后会自动循环"><a href="#表（Table）-设置好后会自动循环" class="headerlink" title="表（Table）(设置好后会自动循环)"></a>表（Table）(设置好后会自动循环)</h3><p>自动展开生成三部分</p><ul><li><p>表头</p></li><li><p>主要区域</p></li><li><p>脚标</p></li></ul><p>表（Table）属性</p><ul><li>设置行类型，通过画笔直接规划分列、分行（绘制后自动扩展）</li></ul><p>数据（Data）属性</p><ul><li>设置数据来源（内表循环制结构，循环限制条件，排序条件等）</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731202756483.png" alt="表示例图"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731202954103.png" alt="表界面设计"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731203015793.png" alt="表数据设置"></p><p>向表中增加行</p><ul><li>选中表头&#x2F;主要区域&#x2F;脚标中的一部分，右键可以新建行</li><li>新增加的行，选择行类型（从table中创建过的行类型中选择），自动扩展创建相应的cell（单元格）</li><li>单元格不需要单独指定在表格中输出的位置，自上而下排列为表单中从左至右的顺序</li><li>表中的每一个部分，可以创建多种行类型</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731203211683.png" alt="创建行"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731203220729.png" alt="设置行类型"></p><h3 id="判断（Alternative）"><a href="#判断（Alternative）" class="headerlink" title="判断（Alternative）"></a>判断（Alternative）</h3><p>是非判断包含一个Condition（判断条件），以及两个分支条件</p><ul><li>按照对条件的判断结果分别执行是非部分</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731203353137.png" alt="判断的示例图片"></p><h3 id="程序代码（Program-Lines）"><a href="#程序代码（Program-Lines）" class="headerlink" title="程序代码（Program Lines）"></a>程序代码（Program Lines）</h3><blockquote><p>程序代码组件允许用户在Smartforms中编辑ABAP代码，此部分类似于封装函数，和外界通过导入导出参数进行交互</p></blockquote><p>只有通过导入&#x2F;导出参数定义过的变量，才可以在程序代码中使用</p><p>导入参数（Input Parameters）</p><ul><li>传入到程序代码块中的参数</li></ul><p>导出参数（Output Parameters）</p><ul><li>从程序代码快中传出的参数</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731203522755.png" alt="代码示例图片"></p><h3 id="循环（Loop）"><a href="#循环（Loop）" class="headerlink" title="循环（Loop）"></a>循环（Loop）</h3><blockquote><p>循环中指定数据来源的内表以及循环输出使用的结构，可以实现将内表数据多行输出</p></blockquote><ul><li>数据（Data）：指定数据来源</li><li>计算（Calculation）</li><li>事件（Events）：表头及脚标的输出设置</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731203623862.png" alt="循环步骤1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731203651656.png" alt="循环步骤2"></p><h3 id="命令（Command）"><a href="#命令（Command）" class="headerlink" title="命令（Command）"></a>命令（Command）</h3><blockquote><p>执行命令，如强制分页等</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731203742240.png" alt="命令示例图片"></p><h3 id="文件夹（Folder）"><a href="#文件夹（Folder）" class="headerlink" title="文件夹（Folder）"></a>文件夹（Folder）</h3><blockquote><p>可以将节点下的元素进行成组管理</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731203831120.png" alt="文件夹示例图片"></p><h3 id="文本（Text）"><a href="#文本（Text）" class="headerlink" title="文本（Text）"></a>文本（Text）</h3><blockquote><p>图示编辑器在新版本中不可使用，新版本MS编辑器只能手动输入</p></blockquote><p>显示文字</p><ul><li>在建立的Text组件中，直接输入文字内容</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731204042229.png" alt="显示文字"></p><p>显示变量</p><ul><li>选择字段清单，选择变量，直接拖拽到文本对象内（MS编辑器只能手动输入）</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731204111627.png" alt="显示变量"></p><h3 id="文本模块（Text-Module）"><a href="#文本模块（Text-Module）" class="headerlink" title="文本模块（Text Module）"></a>文本模块（Text Module）</h3><p>SMARTFORMS-&gt;创建Text Module，录入文字</p><p>在Smartforms的Text元素中使用text module</p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731210914019.png" alt="文本模块步骤1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731211041903.png" alt="文本模块步骤2"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731211117792.png" alt="文本模块步骤3"></p><h3 id="样式（Smart-Styles）"><a href="#样式（Smart-Styles）" class="headerlink" title="样式（Smart Styles）"></a>样式（Smart Styles）</h3><blockquote><p>SmartFroms样式的作用是为了指定Form中的文本属性</p></blockquote><p>如文本的字体、颜色、大小等</p><p>命名规则</p><ul><li>样式：Z&#x2F;Y开头</li></ul><p>包含内容</p><ul><li>表头（Header Data）</li></ul><p>设置默认的字体及段落格式</p><ul><li>段落（Paragraph Formats）</li></ul><p>设置段落格式（包含字符格式）</p><ul><li><p>字符（Character Formats）</p></li><li><p>独立的字符格式</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731211307458.png" alt="创建样式步骤1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731211332627.png" alt="创建样式步骤2"></p><h4 id="表头"><a href="#表头" class="headerlink" title="表头"></a>表头</h4><p>标准设置</p><ul><li>标准段落：设置默认标准段落格式</li><li>字符每英寸：设置字符间距（每英寸中文字符数）</li><li>指标空间：制表符间距</li><li>行每英寸：设置字符安监局（每行中文字符数）</li><li>字体：字体类型&#x2F;大小&#x2F;风格</li><li>下划线</li><li>颜色</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731211439245.png" alt="表头"></p><h4 id="段落样式"><a href="#段落样式" class="headerlink" title="段落样式"></a>段落样式</h4><p>命名规则</p><ul><li>两位字符</li></ul><p>设置页签</p><ul><li>缩进和空格：段落的方式、页边距等设置</li><li>字体：段落字体风格、大小、样式及颜色设置（SE73维护字体）</li><li>标签：段落制表符设置（不推荐使用）</li><li>编号和框架：段落列表编号方式设置</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731211538661.png" alt="段落样式"></p><h4 id="字体格式"><a href="#字体格式" class="headerlink" title="字体格式"></a>字体格式</h4><p>命名规则</p><ul><li>两位字符</li></ul><p>标准设置</p><ul><li>上标</li><li>下标</li><li>条形码（Bar Code）</li></ul><p>字体</p><ul><li>类型</li><li>大小</li><li>样式</li><li>颜色</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731211714625.png" alt="字体格式设置1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731211759752.png" alt="字体格式设置2"></p><h2 id="Smart-Forms的测试及调用"><a href="#Smart-Forms的测试及调用" class="headerlink" title="Smart Forms的测试及调用"></a>Smart Forms的测试及调用</h2><blockquote><p>Smartforms是通过函数进行调用的</p></blockquote><h3 id="在Smartforms界面调用"><a href="#在Smartforms界面调用" class="headerlink" title="在Smartforms界面调用"></a>在Smartforms界面调用</h3><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731212546570.png" alt="检查后点击测试"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731212610155.png" alt="进入此界面"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731212726892.png" alt="激活后执行"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731212754387.png" alt="再次执行"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731213106298.png" alt="配置参数后点击预览即可LP01为模拟打印机"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731213219544.png" alt="预览效果如下，没有数据是因为没在程序中调用"></p><h3 id="在程序中调用"><a href="#在程序中调用" class="headerlink" title="在程序中调用"></a>在程序中调用</h3><p>获取函数名称</p><blockquote><p>Smartforms默认生成的册数函数名称在不同系统间可能不同，因此需要调用函数 SSF_FUNCTION_MODULE_NAME ，获取smartforms测试的函数名称</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">  CALL FUNCTION &#x27;SSF_FUNCTION_MODULE_NAME&#x27;<br>    EXPORTING<br>     formname         = &#x27;ZTEST0002&#x27;<br>\*     VARIANT         = &#x27; &#x27;<br>\*     DIRECT_CALL       = &#x27; &#x27;<br>   IMPORTING<br>     FM_NAME         = fm_name<br>   EXCEPTIONS<br>    NO_FORM         = 1<br>    NO_FUNCTION_MODULE    = 2<br>    OTHERS          = 3<br>        .<br>   IF sy-subrc &lt;&gt; 0.<br>\* Implement suitable error handling here<br>   ENDIF.<br></code></pre></td></tr></table></figure><p>调用函数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">CALL FUNCTION fm_name<br> EXPORTING<br> \*  ARCHIVE_INDEX       =<br> \*  ARCHIVE_INDEX_TAB     =<br> \*  ARCHIVE_PARAMETERS     =<br> \*  CONTROL_PARAMETERS     = l_control_parameters<br> \*  MAIL_APPL_OBJ       =<br> \*  MAIL_RECIPIENT       =<br> \*  MAIL_SENDER        =<br> \*  OUTPUT_OPTIONS       = l_output_options<br>   USER_SETTINGS       = &#x27;&#x27;<br>   NAME = SY-UNAME<br>   TIME = SY-UZEIT<br> \* IMPORTING<br> \*  DOCUMENT_OUTPUT_INFO    =<br> \*  JOB_OUTPUT_INFO      =<br> \*  JOB_OUTPUT_OPTIONS     = l_job_output_options<br>  TABLES<br>   GT_WORK = gt_zewmt0002out<br>  EXCEPTIONS<br>   FORMATTING_ERROR      = 1<br>   INTERNAL_ERROR       = 2<br>   SEND_ERROR         = 3<br>   USER_CANCELED       = 4<br>   OTHERS           = 5<br>      .<br> IF sy-subrc &lt;&gt; 0.<br> \* Implement suitable error handling here<br> ENDIF.<br>  ENDCASE.<br> ENDFORM.<br></code></pre></td></tr></table></figure><p>使用Smartforms调用时的传输参数控制打印参数</p><ul><li>CONTROL_PARAMETERS</li></ul><p>例：实现直接显示预览界面</p><ul><li>OUTPUT_OPTIONS</li></ul><p>例：实现在打印窗口中不显示预览按钮，勾选快速打印按钮</p><ul><li>需要讲USER_SETTINGS值设置为空</li></ul><p>使用返回值判断打印结果</p><ul><li>JOB_OUTPUT_INFO</li></ul><p>例：OUTPUTDONE，判断打印是否完成</p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731214002849.png" alt="打印参数示例图1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731214036187.png" alt="打印参数示例图2"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731214112238.png" alt="打印参数示例图2"></p><h2 id="简单示例"><a href="#简单示例" class="headerlink" title="简单示例"></a>简单示例</h2><p>整体程序：</p><p>smartform设置</p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731214657769.png" alt="大体设计"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731214751544.png" alt="参数设置1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731214837353.png" alt="参数设置2关联类型需要自己创建数据元素"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731215100866.png" alt="表数据设置"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">*&amp;---------------------------------------------------------------------*<br> *&amp; Report ZTEST00020<br> *&amp;---------------------------------------------------------------------*<br> *&amp;<br> *&amp;---------------------------------------------------------------------*<br> REPORT ZTEST00020.<br> INCLUDE ZTEST00020_top.<br> INCLUDE ZTEST00020_form.<br><br> INITIALIZATION.<br><br><br> START-OF-SELECTION.<br>  PERFORM get_data.<br><br> END-OF-SELECTION.<br>  PERFORM display_data.<br> *&amp;---------------------------------------------------------------------*<br> *&amp; Form get_data<br> *&amp;---------------------------------------------------------------------*<br> *&amp; text<br> *&amp;---------------------------------------------------------------------*<br> *&amp; --&gt; p1    text<br> *&amp; &lt;-- p2    text<br> *&amp;---------------------------------------------------------------------*<br> FORM get_data .<br>  SELECT * FROM ZEWMT0002<br>  WHERE LGNUM IN @s_lgnum AND<br>     LGPLA IN @s_LGPLA AND<br>     MAKTX IN @s_MAKTX AND<br>     MATID IN @s_MATID<br>  INTO TABLE @gt_zewmt0002out.<br> ENDFORM.<br> *&amp;---------------------------------------------------------------------*<br> *&amp; Form build_fieldcat<br> *&amp;---------------------------------------------------------------------*<br> *&amp; text<br> *&amp;---------------------------------------------------------------------*<br> *&amp; --&gt; p1    text<br> *&amp; &lt;-- p2    text<br> *&amp;---------------------------------------------------------------------*<br> FORM build_fieldcat .<br>  %%add_fieldcat: &#x27;1&#x27; &#x27;LGNUM&#x27; &#x27;仓库号&#x27;,<br>          &#x27;2&#x27; &#x27;LNUMT&#x27; &#x27;仓库名称&#x27;,<br>          &#x27;3&#x27; &#x27;LGPLA&#x27; &#x27;库位&#x27;,<br>          &#x27;4&#x27; &#x27;MATID&#x27; &#x27;物料编号&#x27;,<br>          &#x27;5&#x27; &#x27;MAKTX&#x27; &#x27;物料描述&#x27;,<br>          &#x27;6&#x27; &#x27;BATCHID&#x27; &#x27;批次&#x27;,<br>          &#x27;7&#x27; &#x27;PKNUM&#x27; &#x27;包数&#x27;,<br>          &#x27;8&#x27; &#x27;QUAN&#x27; &#x27;库存量&#x27;,<br>          &#x27;9&#x27; &#x27;MEINS&#x27; &#x27;单位&#x27;,<br>          &#x27;10&#x27; &#x27;WPTYP&#x27; &#x27;包型&#x27;,<br>          &#x27;11&#x27; &#x27;WPWET&#x27; &#x27;单包重&#x27;,<br>          &#x27;12&#x27; &#x27;HUIDENT&#x27; &#x27;HU号&#x27;.<br> ENDFORM.<br> *&amp;---------------------------------------------------------------------*<br> *&amp; Form build_layout<br> *&amp;---------------------------------------------------------------------*<br> *&amp; text<br> *&amp;---------------------------------------------------------------------*<br> *&amp; --&gt; p1    text<br> *&amp; &lt;-- p2    text<br> *&amp;---------------------------------------------------------------------*<br> FORM build_layout .<br>  gs_layout-colwidth_optimize = &#x27;X&#x27;.<br> ENDFORM.<br> *&amp;---------------------------------------------------------------------*<br> *&amp; Form build_event<br> *&amp;---------------------------------------------------------------------*<br> *&amp; text<br> *&amp;---------------------------------------------------------------------*<br> *&amp; --&gt; p1    text<br> *&amp; &lt;-- p2    text<br> *&amp;---------------------------------------------------------------------*<br> FORM build_event .<br><br> ENDFORM.<br> *&amp;---------------------------------------------------------------------*<br> *&amp; Form display_data<br> *&amp;---------------------------------------------------------------------*<br> *&amp; text<br> *&amp;---------------------------------------------------------------------*<br> *&amp; --&gt; p1    text<br> *&amp; &lt;-- p2    text<br> *&amp;---------------------------------------------------------------------*<br> FORM display_data .<br>  IF gt_zewmt0002out IS NOT INITIAL.<br>   PERFORM build_fieldcat.<br>   PERFORM build_layout.<br>   PERFORM build_event.<br>   CALL FUNCTION &#x27;REUSE_ALV_GRID_DISPLAY&#x27;<br>   EXPORTING<br>    I_CALLBACK_PROGRAM        = SY-REPID<br>    I_CALLBACK_PF_STATUS_SET     = &#x27;SET_STATUS&#x27;<br>    I_CALLBACK_USER_COMMAND      = &#x27;FRM_USER_COMMAND&#x27;<br>    IS_LAYOUT             = gs_layout<br>    IT_FIELDCAT            = gt_fieldcat<br>    TABLES<br>     t_outtab             = gt_zewmt0002out<br>        .<br>   IF sy-subrc &lt;&gt; 0.<br> \* Implement suitable error handling here<br>   ENDIF.<br>  ENDIF.<br> ENDFORM.<br><br> FORM SET_STATUS USING RT_EXTAB TYPE SLIS_T_EXTAB.<br>  SET PF-STATUS &#x27;ZUI&#x27;.<br> ENDFORM.<br><br> FORM FRM_USER_COMMAND USING R_UCOMM LIKE SY-UCOMM RS_SELFIELD TYPE SLIS_SELFIELD.<br>  CASE R_UCOMM.<br>   WHEN &#x27;&amp;PRINT&#x27;.<br>    CALL FUNCTION &#x27;SSF_FUNCTION_MODULE_NAME&#x27;<br>     EXPORTING<br>      formname         = &#x27;ZTEST0002&#x27;<br> \*     VARIANT         = &#x27; &#x27;<br> \*     DIRECT_CALL       = &#x27; &#x27;<br>    IMPORTING<br>      FM_NAME         = fm_name<br>    EXCEPTIONS<br>     NO_FORM         = 1<br>     NO_FUNCTION_MODULE    = 2<br>     OTHERS          = 3<br>         .<br>    IF sy-subrc &lt;&gt; 0.<br> \* Implement suitable error handling here<br>    ENDIF.<br><br>  CALL FUNCTION fm_name<br> EXPORTING<br> \*  ARCHIVE_INDEX       =<br> \*  ARCHIVE_INDEX_TAB     =<br> \*  ARCHIVE_PARAMETERS     =<br> \*  CONTROL_PARAMETERS     = l_control_parameters<br> \*  MAIL_APPL_OBJ       =<br> \*  MAIL_RECIPIENT       =<br> \*  MAIL_SENDER        =<br> \*  OUTPUT_OPTIONS       = l_output_options<br>   USER_SETTINGS       = &#x27;&#x27;<br>   NAME = SY-UNAME<br>   TIME = SY-UZEIT<br> \* IMPORTING<br> \*  DOCUMENT_OUTPUT_INFO    =<br> \*  JOB_OUTPUT_INFO      =<br> \*  JOB_OUTPUT_OPTIONS     = l_job_output_options<br>  TABLES<br>   GT_WORK = gt_zewmt0002out<br>  EXCEPTIONS<br>   FORMATTING_ERROR      = 1<br>   INTERNAL_ERROR       = 2<br>   SEND_ERROR         = 3<br>   USER_CANCELED       = 4<br>   OTHERS           = 5<br>      .<br> IF sy-subrc &lt;&gt; 0.<br> \* Implement suitable error handling here<br> ENDIF.<br><br>  ENDCASE.<br> ENDFORM.<br></code></pre></td></tr></table></figure><p>效果演示：</p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731214212129.png" alt="运行效果1"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731214248541.png" alt="运行效果2"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731214317813.png" alt="点击打印"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230731214353962.png" alt="打印效果预览"></p>]]></content>
    
    
    <categories>
      
      <category>ABAP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SAP</tag>
      
      <tag>ABAP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>FUNCTION ALV的设置与使用</title>
    <link href="/2023/07/29/FUNCTION_ALV/"/>
    <url>/2023/07/29/FUNCTION_ALV/</url>
    
    <content type="html"><![CDATA[<h1 id="SAP-FUNCTION-ALV的设置与使用"><a href="#SAP-FUNCTION-ALV的设置与使用" class="headerlink" title="SAP FUNCTION ALV的设置与使用"></a>SAP FUNCTION ALV的设置与使用</h1><blockquote><p>ALV：SAPListViewer</p></blockquote><h2 id="LAYOUT设置"><a href="#LAYOUT设置" class="headerlink" title="LAYOUT设置"></a>LAYOUT设置</h2><blockquote><p>用于设置ALV整体输出格式，为ALV可选参数。属于类型池 TYPE-POOLS:SLIS</p></blockquote><p>代码定义：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">TYPE-POOLS:slis.<br>DATA: layout TYPE slis_layout_alv.<br>layout-[字段名] = ‘xxxx’.<br></code></pre></td></tr></table></figure><table><thead><tr><th align="left">字段名</th><th>长度</th><th>类型参考</th><th>描述</th></tr></thead><tbody><tr><td align="left">no_colhead</td><td>1</td><td>TYPE C</td><td>no headings 不显示列标题行</td></tr><tr><td align="left">no_hotspot</td><td>1</td><td>TYPE C</td><td>headings not as hotspot</td></tr><tr><td align="left">zebra</td><td>1</td><td>TYPE C</td><td>striped pattern斑马线显示，颜色隔行交替显示</td></tr><tr><td align="left">no_vline</td><td>1</td><td>TYPE C</td><td>columns separated by space不显示垂直网格线</td></tr><tr><td align="left">no_hline</td><td>1</td><td>TYPE C</td><td>rows separated by space B20K8A0N5D不显示水平网格线</td></tr><tr><td align="left">cell_merge</td><td>1</td><td>TYPE C</td><td>not suppress field replication ALV单元格中的内容能够复制到剪贴板</td></tr><tr><td align="left">edit</td><td>1</td><td>TYPE C</td><td>for grid onlyALV是否可编辑，注意只对Grid模式有效，对List模式无效</td></tr><tr><td align="left">numc_sum</td><td>1</td><td>TYPE C</td><td>totals for NUMC-Fields possib</td></tr><tr><td align="left">no_input</td><td>1</td><td>TYPE C</td><td>only display fields</td></tr><tr><td align="left">f2code</td><td></td><td>LIKE sy-ucomm</td><td>设置触发弹出详细信息窗口的功能码</td></tr><tr><td align="left">reprep</td><td>1</td><td>TYPE C</td><td>report report interface active</td></tr><tr><td align="left">no_keyfix</td><td>1</td><td>TYPE C</td><td>do not fix keycolumns</td></tr><tr><td align="left">expand_all</td><td>1</td><td>TYPE C</td><td>Expand all positions</td></tr><tr><td align="left">no_author</td><td>1</td><td>TYPE C</td><td>No standard authority check</td></tr><tr><td align="left">def_status</td><td>1</td><td>TYPE C</td><td>default status space or ‘A’</td></tr><tr><td align="left">item_text</td><td>20</td><td>TYPE C</td><td>Text for item button</td></tr><tr><td align="left">countfname</td><td></td><td>TYPE lvc_fname</td><td></td></tr><tr><td align="left">colwidth_optimize</td><td>1</td><td>TYPE C</td><td>ALV网格（单元格）宽度设置为自动最优化，按输出内容宽度自动调整</td></tr><tr><td align="left">no_min_linesize</td><td>1</td><td>TYPE C</td><td>TYPE Cline size &#x3D; width of the list</td></tr><tr><td align="left">min_linesize</td><td></td><td>LIKE sy-linsz</td><td>if initial min_linesize &#x3D; 80</td></tr><tr><td align="left">max_linesize</td><td></td><td>LIKE sy-linsz</td><td>Default 250</td></tr><tr><td align="left">window_titlebar</td><td></td><td>like sy-title</td><td></td></tr><tr><td align="left">no_uline_hs</td><td>1</td><td>TYPE C</td><td>fieldname for exception列显示为红绿灯</td></tr><tr><td align="left">lights_fieldname</td><td></td><td>type slis_fieldname</td><td></td></tr><tr><td align="left">lights_tabname</td><td></td><td>type slis_tabname</td><td>fieldname for exception</td></tr><tr><td align="left">lights_rollname</td><td></td><td>like dfies-rollname</td><td>rollname f. exceptiondocu</td></tr><tr><td align="left">lights_condense</td><td>1</td><td>TYPE C</td><td>fieldname for exception</td></tr><tr><td align="left">no_sumchoice</td><td>1</td><td>TYPE C</td><td>no choice for summing up</td></tr><tr><td align="left">no_totalline</td><td>1</td><td>TYPE C</td><td>no total line</td></tr><tr><td align="left">no_subchoice</td><td>1</td><td>TYPE C</td><td>no choice for subtotals</td></tr><tr><td align="left">no_subtotals</td><td>1</td><td>TYPE C</td><td>no subtotals possible</td></tr><tr><td align="left">no_unit_splitting</td><td></td><td>TYPE C</td><td>no sep. tot.lines by inh.units</td></tr><tr><td align="left">totals_before_items</td><td></td><td>TYPE C</td><td>diplay totals before the items统计行会在数据行前面显示</td></tr><tr><td align="left">totals_only</td><td>1</td><td>TYPE C</td><td>show only totals只显示合计</td></tr><tr><td align="left">totals_text</td><td>60</td><td>TYPE C</td><td>text for 1st col. in total line合计第一列文本</td></tr><tr><td align="left">subtotals_text</td><td>60</td><td>TYPE C</td><td>text for 1st col. in subtotals</td></tr><tr><td align="left">box_fieldname</td><td></td><td>type slis_fieldname</td><td>fieldname for checkbox指定数据内表中哪列以选择按钮形式显示（首列前可按下或弹上来的按钮），ALV最左上角会出现全选按钮</td></tr><tr><td align="left">box_tabname</td><td></td><td>type slis_tabname</td><td>tabname for checkbox</td></tr><tr><td align="left">box_rollname</td><td></td><td>like dd03p-rollname</td><td>rollname for checkbox</td></tr><tr><td align="left">expand_fieldname</td><td></td><td>type slis_fieldname</td><td>fieldname flag ‘expand’</td></tr><tr><td align="left">hotspot_fieldname</td><td></td><td>type slis_fieldname</td><td>fieldname flag hotspot</td></tr><tr><td align="left">confirmation_prompt</td><td></td><td></td><td>confirm. prompt when leaving当退出ALV报表展示界面时，是否需要提示用户</td></tr><tr><td align="left">key_hotspot</td><td>1</td><td>TYPE C</td><td>keys as hotspot  K_KEYHOT设置关键字段是否是热点，可单击</td></tr><tr><td align="left">flexible_key</td><td>1</td><td>TYPE C</td><td>key columns movable,…</td></tr><tr><td align="left">group_buttons</td><td>1</td><td>TYPE C</td><td>buttons for COL1 - COL5</td></tr><tr><td align="left">get_selinfos</td><td>1</td><td>TYPE C</td><td>read selection screen</td></tr><tr><td align="left">group_change_edit</td><td>1</td><td>TYPE C</td><td>Settings by user for new group</td></tr><tr><td align="left">no_scrolling</td><td>1</td><td>TYPE C</td><td>no scrolling</td></tr><tr><td align="left">detail_popup</td><td>1</td><td>TYPE C</td><td>show detail in popup 右键中有 Detail 菜单，是否弹出详细信息窗口</td></tr><tr><td align="left">detail_initial_lines</td><td>1</td><td>TYPE C</td><td>show also initial lines为空行时单元格内容也会显示在右键弹出的详细框中</td></tr><tr><td align="left">detail_titlebar</td><td></td><td>like sy-title</td><td>Titlebar for detail设置详细弹出窗口的标题栏</td></tr><tr><td align="left">header_text</td><td>20</td><td>TYPE C</td><td>Text for header button</td></tr><tr><td align="left">default_item</td><td>1</td><td>TYPE C</td><td>Items as default</td></tr><tr><td align="left">info_fieldname</td><td></td><td>type slis_fieldname</td><td>infofield for listoutput 指定数据输出内表中哪列存储的是颜色，用来设置ALV每行数据的颜色。</td></tr><tr><td align="left">coltab_fieldname</td><td></td><td>type slis_fieldname</td><td>colors</td></tr><tr><td align="left">list_append</td><td>1</td><td>TYPE C</td><td>no call screen</td></tr><tr><td align="left">xifunckey</td><td></td><td>type aqs_xikey</td><td>eXtended interaction(SAPQuery)</td></tr><tr><td align="left">xidirect</td><td></td><td>type flag</td><td>eXtended INTeraction(SAPQuery)</td></tr><tr><td align="left">dtc_layout</td><td></td><td>type dtc_s_layo</td><td>Layout for configure the Tabstip</td></tr><tr><td align="left">allow_switch_to_list</td><td>1</td><td>TYPE C</td><td>ACC: Switch from FullGrid to List</td></tr></tbody></table><h2 id="FIELDCAT设置"><a href="#FIELDCAT设置" class="headerlink" title="FIELDCAT设置"></a>FIELDCAT设置</h2><blockquote><p>用于ALV数据显示结构的定义，包括具体的栏位名称、类型、各字段的输出格式（与Layout不一样的是输出格式只针对某个字段），为ALV必选参数</p></blockquote><p>此处使用宏来完成添加操作</p><p>代码定义：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">gt_fieldcat TYPE lvc_t_fcat,<br>gs_fieldcat TYPE lvc_s_fcat.<br><br>DEFINE %%APPEND_FIELDCAT.<br>  CLEAR gs_fieldcat.<br>  gs_fieldcat-col_pos = &amp;1.<br>  gs_fieldcat-fieldname = &amp;2.<br>  gs_fieldcat-outputlen = &amp;3.<br>  gs_fieldcat-scrtext_m = &amp;4.<br>  gs_fieldcat-edit = &amp;5.<br>  gs_fieldcat-checkbox = &amp;6.<br>  APPEND gs_fieldcat TO gt_fieldcat.<br>END-OF-DEFINITION.<br><br>%%APPEND_FIELDCAT: &#x27;1&#x27; &#x27;ebeln&#x27; &#x27;10&#x27; &#x27;采购凭证编号&#x27; &#x27;&#x27; &#x27;&#x27; ,<br>                   &#x27;2&#x27; &#x27;bukrs&#x27; &#x27;10&#x27; &#x27;公司代码&#x27; &#x27;X&#x27; &#x27;&#x27; ,<br>                   &#x27;3&#x27; &#x27;bsart&#x27; &#x27;10&#x27; &#x27;采购凭证类型&#x27; &#x27;X&#x27; &#x27;&#x27; ,<br>                   &#x27;4&#x27; &#x27;lifnr&#x27; &#x27;10&#x27; &#x27;供应商账户号&#x27; &#x27;X&#x27; &#x27;&#x27; ,<br>                   &#x27;5&#x27; &#x27;zterm&#x27; &#x27;10&#x27; &#x27;付款条件代码&#x27; &#x27;X&#x27; &#x27;&#x27; ,<br>                   &#x27;6&#x27; &#x27;slect&#x27; &#x27;2&#x27; &#x27;选择&#x27; &#x27;X&#x27; &#x27;X&#x27; .<br></code></pre></td></tr></table></figure><table><thead><tr><th>字段名</th><th>长度</th><th>类型参考</th><th>描述</th></tr></thead><tbody><tr><td>row_pos</td><td></td><td>like sy-curow</td><td>output in row</td></tr><tr><td>col_pos</td><td></td><td>like sy-cucol</td><td>position of the column列的输出位置字段在表中第几列</td></tr><tr><td>fieldname</td><td></td><td>type slis_fieldname</td><td>针对输出内表哪列进行设置，只有设置了的列才会显示，如果没有设置，则不会显示在ALV中。如果此字段是CURR(currency field) ,QUAN(Quantity field) 需要指定相应的CUKY, UNIT字段.需设置Cfieldname、Ctabname和Qfieldname、 Qtabname</td></tr><tr><td>tabname</td><td></td><td></td><td>type slis_tabname,</td></tr><tr><td>currency</td><td>5</td><td>type c</td><td>TCURX表中的货币名称</td></tr><tr><td>cfieldname</td><td></td><td>type slis_fieldname</td><td>field with currency unit金额字段所参照的货币单位字段名称（货币单位字段为数据内表中的某列？）</td></tr><tr><td>ctabname</td><td></td><td>type slis_tabname</td><td></td></tr><tr><td>ifieldname</td><td></td><td>initial column</td><td>initial column</td></tr><tr><td>quantity</td><td>3</td><td>type c</td><td>计量单位</td></tr><tr><td>qfieldname</td><td></td><td>type slis_fieldname</td><td>field with quantity unit</td></tr><tr><td>qtabname</td><td></td><td>type slis_tabname</td><td></td></tr><tr><td>roundtypei</td><td></td><td></td><td>round in write statement四舍五入至小数点后多少位</td></tr><tr><td>exponent</td><td>3</td><td>type c</td><td>exponent for floats浮点数的幂指数为多少位</td></tr><tr><td>key</td><td>1</td><td>type c</td><td>column with key-color指定字段是否是关键字段，如果是则单元格显示的颜色会不同，并会靠前显示</td></tr><tr><td>icon</td><td>1</td><td>type c</td><td>as icon字段将以图标形式显示，INCLUDE <list> ，图标字段内容来自list Inc.文件</td></tr><tr><td>symbol</td><td>1</td><td>type c</td><td>as symbol字段内容作为符号输出，与上面的ICON属性相似</td></tr><tr><td>checkbox</td><td>1</td><td>type c</td><td>as checkbox字段将以复选框形式显示</td></tr><tr><td>just</td><td>1</td><td>type c</td><td>(R)ight (L)eft (C)ent.单元格中内容显示时对齐方式。不设置时按钮数据类型默认对齐方式来对齐</td></tr><tr><td>lzero</td><td>1</td><td>type c</td><td>leading zero  为X时输出前导零</td></tr><tr><td>no_sign</td><td>1</td><td>type c,</td><td>write no-sign 不显示数字符号</td></tr><tr><td>no_zero</td><td>1</td><td>type c</td><td>write no-zero 只输出有意义的值,空值不输出。为X时全为零（如：00000）时不输出，所以不输出零时应该最好同时设置lzero &#x3D; sapce与no_zero &#x3D; X，相反如果要输出，则应同时设置lzero &#x3D; X 与no_zero &#x3D; space</td></tr><tr><td>no_convext</td><td>1</td><td>type c</td><td></td></tr><tr><td>edit_mask</td><td></td><td>type slis_edit_mask</td><td>对字段内容进行掩码格式化输出，具体请参照《ABAP BC Programming.docx》中的WRITE … TO章节，如：gt_fieldcat-edit_mask &#x3D; ‘_<em><strong>&#x2F;</strong>&#x2F;</em>_’可对日期字段都日期格式化显</td></tr><tr><td>emphasize</td><td>4</td><td>type c</td><td>emphasize设置列的颜色</td></tr><tr><td>fix_column</td><td>1</td><td>type c</td><td>Spalte fixieren列固定不滚动，与Key属性相似，但颜色不会发生变化</td></tr><tr><td>do_sum</td><td>1</td><td>type c</td><td>sum up该列是否进行小计，需与gt_sort-subtot一起使用（即需要参考排序），否则只对整列进行一个合计</td></tr><tr><td>no_out</td><td>1</td><td>type c</td><td>(O)blig.(X)no out但注意用户可以change layout（布局设置）来显示出此列</td></tr><tr><td>tech</td><td>1</td><td>type c</td><td>technical field该字段为技术字段：设置为技术列的列将不会再显示出来，即使是在布局设置里也是看不到的</td></tr><tr><td>outputlen</td><td></td><td>like dd03p-outputlen</td><td>列的字符输出宽度</td></tr><tr><td>offset</td><td></td><td>type dd03p-outputlen</td><td>offset</td></tr><tr><td>ref_fieldname</td><td></td><td>like dd03p-fieldname</td><td>如需单元格显示F4输入帮助，则需要指定字段所参照的表名</td></tr><tr><td>roundfieldname</td><td></td><td>type slis_fieldname</td><td></td></tr><tr><td>decimalsfieldname</td><td></td><td>type slis_fieldname</td><td></td></tr><tr><td>decimalstabname</td><td></td><td>type slis_tabname</td><td></td></tr><tr><td>decimals_out</td><td>6</td><td>type c</td><td>控制小数点的位数</td></tr><tr><td>text_fieldname</td><td></td><td>type slis_fieldname</td><td></td></tr><tr><td>ddic_outputlen</td><td></td><td>like dd03p-outputlen</td><td></td></tr><tr><td>key_sel</td><td>1</td><td>type c</td><td>field not obligatory</td></tr><tr><td>no_sum</td><td>1</td><td>type c</td><td>do not sum up</td></tr><tr><td>sp_group</td><td>4</td><td>type c</td><td>group specification</td></tr><tr><td>reprep</td><td>1</td><td>type c</td><td>selection for rep&#x2F;rep</td></tr><tr><td>input</td><td></td><td>type c</td><td>input</td></tr><tr><td>edit</td><td>1</td><td>type c</td><td>internal use only是否可编辑</td></tr><tr><td>hotspot</td><td>1</td><td>type c</td><td>hotspot设置字段内容下面是否有热点（有下划线，可点击，单击即可触发相应事件）</td></tr><tr><td><strong>datatype</strong></td><td></td><td>like dd03p-datatype</td><td><a href="#datatype">具体请看下面的特别说明</a></td></tr></tbody></table><blockquote><p>调整输出列抬头的文本:文本可以随着用户调整列的宽度而变化,其文本即是在对应data element中定义的,如果需要定制,则可以指定以下字段</p></blockquote><table><thead><tr><th>字段名</th><th>长度</th><th>类型参考</th><th>描述</th></tr></thead><tbody><tr><td>seltext_l</td><td></td><td>like dd03p-scrtext_l</td><td>long key word标题字段显示的名称（长）</td></tr><tr><td>seltext_m</td><td></td><td>like dd03p-scrtext_m</td><td>middle key word标题字段显示的名称（中）</td></tr><tr><td>seltext_s</td><td></td><td>like dd03p-scrtext_s</td><td>short key word标题字段显示的名称（短）</td></tr><tr><td>ddictxt</td><td>1</td><td>type c</td><td>(S)hort (M)iddle (L)ong设置以长、中还是短名称来显示，取值分别为 S、M、L。直接指定文本显示为长文本、中、还是短文本, 指定这个字段后则会固定下来,不会随着用户的宽度调整变化，具体代码实现参考。</td></tr><tr><td>reptext_ddic</td><td></td><td>like dd03p-reptext</td><td>heading (ddic)，(header) Analogous（相似） to the Data element main header</td></tr><tr><td>rollname</td><td></td><td>like dd03p-rollname</td><td>F1帮助需参照的DataElement，在ALV的显示界面将鼠标放到该字段的位置后按F1会弹出该字段的说明。另外，可以不指明字段的描述（如seltext_l、seltext_m、seltext_s），函数会自动将字段的描述显示为该参照的数据元素</td></tr></tbody></table><p>两个属性在字段如果是金额或P小数（数量）类型时，需要对datatype此属性进行设置，否则，如果不设置时，在修改对应单元格内容时，会自动将你所输入的数除100，即小数点提前两位；并且如果是数量类型，除了设置datatype外，inttype也需要进行设置，且为 C，具体实现请参考这里：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">datatype LIKE dd03p-datatype,<br>inttype LIKE dd03p-inttype,<br>intlen  LIKE dd03p-intlen,<br>lowercase LIKE dd03p-lowercase,<br></code></pre></td></tr></table></figure><h2 id="函数设置"><a href="#函数设置" class="headerlink" title="函数设置"></a>函数设置</h2><blockquote><p>REUSE_ALV_GRID_DISPLAY GRID模式</p><p>REUSE_ALV_LIST_DISPLAY LIST模式</p></blockquote><p>REUSE_ALV_GRID_DISPLAY与REUSE_ALV_LIST_DISPLAY函数的参数基本相同：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">CALLFUNCTION&#x27;REUSE_ALV_GRID_DISPLAY&#x27;<br>* EXPORTING<br>*   I_INTERFACE_CHECK                 = &#x27; &#x27;<br>*   I_BYPASSING_BUFFER                = &#x27; &#x27;<br>*   I_BUFFER_ACTIVE                   = &#x27; &#x27;<br>*   I_CALLBACK_PROGRAM                = &#x27; &#x27;回调函数、待输出数据内表所在的程序名，一般为本程序，但一般不要直接使用SY-REPID系统变量，因为可能出现多层次调用（一个程序调用另一程序，形成调用链时）SY-REPID可能不是最后想要的程序<br>*   I_CALLBACK_PF_STATUS_SET          = &#x27; &#x27;设置工具栏<br>*   I_CALLBACK_USER_COMMAND           = &#x27; &#x27;工具栏按钮或数据行事件触发时所要调用的Form<br>*   I_CALLBACK_TOP_OF_PAGE            = &#x27; &#x27;<br>*   I_CALLBACK_HTML_TOP_OF_PAGE       = &#x27; &#x27;<br>*   I_CALLBACK_HTML_END_OF_LIST       = &#x27; &#x27;<br>*   I_STRUCTURE_NAME                  =如果输出内表的结构参照的就是表结构，则可以不用指定fieldcat，直接使用这个词典结构，函数会自动根据此结构来生成fieldcat。在实际业务中一般是从多个表读取数据，因此直接使用字典结构作为字段目录的情况不常见；另外，可与IT_FIELDCAT混合使用，手动的IT_FIELDCAT级别优先<br>*   I_BACKGROUND_ID                   = &#x27; &#x27;设置报表背景图片？<br>*   I_GRID_TITLE                      = ALV标题名<br>*   I_GRID_SETTINGS                   =设置（打印、网格中的数据同步更新到输出数据内表）<br>*   IS_LAYOUT                         = ALV Layout<br>*   IT_FIELDCAT                       = FieldCat配置<br>*   IT_EXCLUDING                      =<br>*   IT_SPECIAL_GROUPS                 =<br>*   IT_SORT                           =<br>*   IT_FILTER                         =<br>*   IS_SEL_HIDE                       =<br>*   I_DEFAULT                         = &#x27;X&#x27;用户是否可以设置默认的布局变式（即是否可以将某个布局变式设置为默认的布局）: &#x27;X&#x27; 可以定义默认布局，SPACE 不可以定义默认布局image003[6]<br>*   I_SAVE                            = &#x27; &#x27;保存表格布局：&#x27;X&#x27; 只能保存为全局标准变式，&#x27;U&#x27; 只能保存特定用户变式，&#x27;A&#x27;都可以保存，SPACE不能保存变式<br>*   IS_VARIANT                        =<br>*   IT_EVENTS                         =<br>*   IT_EVENT_EXIT                     =<br>*   IS_PRINT                          =从后端开始打印的参数<br>*   IS_REPREP_ID                      =<br>*   I_SCREEN_START_COLUMN             = 0<br>*   I_SCREEN_START_LINE               = 0<br>*   I_SCREEN_END_COLUMN               = 0<br>*   I_SCREEN_END_LINE                 = 0<br>*   I_HTML_HEIGHT_TOP                 = 0<br>*   I_HTML_HEIGHT_END                 = 0<br>*   IT_ALV_GRAPHICS                   =<br>*   IT_HYPERLINK                      =<br>*   IT_ADD_FIELDCAT                   =<br>*   IT_EXCEPT_QINFO                   =<br>*   IR_SALV_FULLSCREEN_ADAPTER        =<br>* IMPORTING<br>*   E_EXIT_CAUSED_BY_CALLER           =<br>*   ES_EXIT_CAUSED_BY_USER            =<br>TABLES<br>t_outtab                          =需要显示的数据内表<br>* EXCEPTIONS<br>*   PROGRAM_ERROR                     = 1<br>*   OTHERS                            = 2<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">CALLFUNCTION&#x27;REUSE_ALV_LIST_DISPLAY&#x27;<br>* EXPORTING<br>*   I_INTERFACE_CHECK              = &#x27; &#x27;<br>*   I_BYPASSING_BUFFER             =<br>*   I_BUFFER_ACTIVE                = &#x27; &#x27;<br>*   I_CALLBACK_PROGRAM             = &#x27; &#x27;<br>*   I_CALLBACK_PF_STATUS_SET       = &#x27; &#x27;<br>*   I_CALLBACK_USER_COMMAND        = &#x27; &#x27;<br>*   I_STRUCTURE_NAME               =<br>*   IS_LAYOUT                      =<br>*   IT_FIELDCAT                    =<br>*   IT_EXCLUDING                   =<br>*   IT_SPECIAL_GROUPS              =<br>*   IT_SORT                        =<br>*   IT_FILTER                      =<br>*   IS_SEL_HIDE                    =<br>*   I_DEFAULT                      = &#x27;X&#x27;<br>*   I_SAVE                         = &#x27; &#x27;<br>*   IS_VARIANT                     =<br>*   IT_EVENTS                      =<br>*   IT_EVENT_EXIT                  =<br>*   IS_PRINT                       =<br>*   IS_REPREP_ID                   =<br>*   I_SCREEN_START_COLUMN          = 0<br>*   I_SCREEN_START_LINE            = 0<br>*   I_SCREEN_END_COLUMN            = 0<br>*   I_SCREEN_END_LINE              = 0<br>*   IR_SALV_LIST_ADAPTER           =<br>*   IT_EXCEPT_QINFO                =<br>*   I_SUPPRESS_EMPTY_DATA          = ABAP_FALSE<br>* IMPORTING<br>*   E_EXIT_CAUSED_BY_CALLER        =<br>*   ES_EXIT_CAUSED_BY_USER         =<br>TABLES<br>  t_outtab                       =<br>* EXCEPTIONS<br>*   PROGRAM_ERROR                  = 1<br>*   OTHERS                         = 2<br></code></pre></td></tr></table></figure><h2 id="EVENT设置"><a href="#EVENT设置" class="headerlink" title="EVENT设置"></a>EVENT设置</h2><p>需要将<code>gt_events </code>配置到函数参数中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">IT_EVENTS = gt_event<br></code></pre></td></tr></table></figure><p>代码定义：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">TYPE-POOLS:SLIS.<br>DATA: gt_events TYPE SLIS_T_EVENT,<br>      gs_event TYPE SLIS_ALV_EVENT.<br>gs_event-name = gs_event-form = &#x27;DATA_CHANGED&#x27;. ##添加DATACHANGED事件<br>APPEND gs_event TO gt_events.<br></code></pre></td></tr></table></figure><h2 id="标题设置"><a href="#标题设置" class="headerlink" title="标题设置"></a>标题设置</h2><p>传统标题</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">FORM frm_top_page.&quot; USING co_doc TYPE cl_dd_document.<br><br>* ALV Header declarations<br>  DATA : lt_header TYPE slis_t_listheader,<br>         ls_header TYPE slis_listheader,<br>         t_line    LIKE ls_header-info,<br>         ld_lines  TYPE i,<br>         ld_linesc(10) TYPE c.<br><br>* 查询条件<br>  CLEAR : ls_header.<br>  ls_header-typ  = &#x27;S&#x27;.<br>  ls_header-key  = &#x27;注意: &#x27;.<br>  ls_header-info = &#x27;同一张提单，涉及多张发货指令单，提单则默认是否我司运输、是否含运费、是否赊销为空。&#x27;.<br>  APPEND ls_header TO lt_header.<br><br>  CALL FUNCTION &#x27;REUSE_ALV_COMMENTARY_WRITE&#x27;<br>    EXPORTING<br>      it_list_commentary = lt_header.<br><br>ENDFORM.              <br></code></pre></td></tr></table></figure><p>html标题</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">FORM html_top_of_page USING DOCUMENT TYPE REF TO CL_DD_DOCUMENT.<br>     DATA : m_p TYPE I ,<br>            m_buffer TYPE STRING.<br>     CONCATENATE &#x27;&lt;html&gt;&lt;center&gt;&lt;h1&gt;&#x27;<br>                  &#x27;考核程序&#x27;<br>                  &#x27;&lt;/h1&gt;&lt;/center&gt;&lt;/html&gt;&#x27;<br>                  INTO  m_buffer.<br>     CALL  METHOD DOCUMENT-&gt;HTML_INSERT   &quot;使用html insert css布局保证了 标题永远居中<br>     EXPORTING<br>      CONTENTS = m_buffer<br>     CHANGING<br>       POSITION = M_P.<br>ENDFORM.<br></code></pre></td></tr></table></figure><h2 id="自定义STATUS"><a href="#自定义STATUS" class="headerlink" title="自定义STATUS"></a>自定义STATUS</h2><h3 id="拷贝标准GUI状态"><a href="#拷贝标准GUI状态" class="headerlink" title="拷贝标准GUI状态"></a>拷贝标准GUI状态</h3><blockquote><p>从<code>SLVC_FULLSCREEN</code>函数组中的拷贝STANDARD_FULLSCREENGui Status，再在此基础之上新增按钮即可</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730174803455.png" alt="image-20230730174803455"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730174939640.png" alt="image-20230730174939640"></p><p>右键&#x3D;&gt;复制&#x3D;&gt;进入对话框</p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730175047112.png" alt="image-20230730175047112"></p><h3 id="创建功能按钮"><a href="#创建功能按钮" class="headerlink" title="创建功能按钮"></a>创建功能按钮</h3><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730093305438.png" alt="image-20230730093305438"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730093536517.png" alt="image-20230730093536517"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730093615450.png" alt="image-20230730093615450"></p><p><strong>创建好后一定要激活！！！</strong></p><h3 id="指定自定义GUI状态"><a href="#指定自定义GUI状态" class="headerlink" title="指定自定义GUI状态"></a>指定自定义GUI状态</h3><blockquote><p>需要将<code>I_CALLBACK_PF_STATUS_SET </code>配置到函数参数中：</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">I_CALLBACK_PF_STATUS_SET = &#x27;ALV_STATUS_SET&#x27;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">FORM alv_status_set USING RT_EXTAB TYPE SLIS_T_EXTAB.<br>    SET PF-STATUS &#x27;ZUI&#x27;.<br>ENDFORM.<br></code></pre></td></tr></table></figure><h3 id="编写相应事件"><a href="#编写相应事件" class="headerlink" title="编写相应事件"></a>编写相应事件</h3><blockquote><p>需要将<code>FRM_USER_COMMAND</code>配置到函数参数中：</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">I_CALLBACK_USER_COMMAND = &#x27;FRM_USER_COMMAND&#x27;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">FORM FRM_USER_COMMAND USING R_UCOMM LIKE SY-UCOMM RS_SELFIELD TYPE SLIS_SELFIELD.<br>  DATA: l_grid TYPE REF TO cl_gui_alv_grid,<br>        lt_zyc003 TYPE STANDARD TABLE OF zyc003,<br>        ls_zyc003 LIKE LINE OF lt_zyc003.<br>  CASE R_UCOMM.<br>    WHEN &#x27;&amp;ADD&#x27;.<br>        DATA: lines TYPE i.<br>        CLEAR gs_zyc003.<br>        CLEAR gt_zyc003.<br>        INSERT INITIAL LINE INTO gt_alv_zyc003 INDEX 1.<br>        INSERT INITIAL LINE INTO gt_zyc003 INDEX 1.<br>        IF sy-subrc = 0.<br>           READ TABLE gt_alv_zyc003 INTO gs_alv_zyc003 INDEX 1.<br>           CLEAR gs_alv_zyc003-field_style.<br>           lines = LINES( gt_alv_zyc003 ) + 1.<br>           gs_alv_zyc003-ebeln = lines.<br>           gs_zyc003-ebeln = lines.<br>           MODIFY gt_alv_zyc003 FROM gs_alv_zyc003 INDEX 1.<br>           MODIFY gt_zyc003 FROM gs_zyc003 INDEX 1.<br>           INSERT zyc003 FROM TABLE gt_zyc003.<br>           COMMIT WORK.<br>           CLEAR gs_zyc003.<br>           CLEAR gt_zyc003.<br>           CLEAR gs_alv_zyc003.<br>        ENDIF.<br>        RS_SELFIELD-refresh = &#x27;X&#x27;.<br>    WHEN &#x27;&amp;ZSAVE&#x27;.<br>       CLEAR lt_zyc003.<br>       CLEAR ls_zyc003.<br>*------------将ALV上修改的内容保存到内表---------------------------------*<br>      CALL FUNCTION &#x27;GET_GLOBALS_FROM_SLVC_FULLSCR&#x27;<br>        IMPORTING<br>          e_grid = l_grid.<br>      CALL METHOD l_grid-&gt;check_changed_data.<br>      LOOP AT gt_alv_zyc003 INTO gs_alv_zyc003 WHERE slect = &#x27;X&#x27;.<br>        ls_zyc003-ebeln = gs_alv_zyc003-ebeln.<br>        ls_zyc003-bukrs = gs_alv_zyc003-bukrs.<br>        ls_zyc003-bsart = gs_alv_zyc003-bsart.<br>        ls_zyc003-lifnr = gs_alv_zyc003-lifnr.<br>        ls_zyc003-zterm = gs_alv_zyc003-zterm.<br>        APPEND ls_zyc003 TO lt_zyc003.<br>      ENDLOOP.<br>      UPDATE zyc003 FROM TABLE lt_zyc003.<br>      commit WORK.<br>      rs_selfield-refresh = &#x27;X&#x27;.  &quot;自动刷新<br><br>    WHEN &#x27;&amp;EDIT&#x27;.<br>      LOOP AT gt_alv_zyc003 INTO gs_alv_zyc003.<br>        IF gs_alv_zyc003-slect = &#x27;X&#x27;.<br>            CLEAR gs_alv_zyc003-field_style.<br>            MODIFY gt_alv_zyc003 FROM gs_alv_zyc003.<br>            rs_selfield-refresh = &#x27;X&#x27;.<br>        ENDIF.<br>        CLEAR gs_alv_zyc003.<br>      ENDLOOP.<br>    WHEN &#x27;&amp;SEA&#x27;.<br>      LOOP AT gt_alv_zyc003 INTO gs_alv_zyc003.<br>        gs_alv_zyc003-slect = &#x27;X&#x27;.<br>        MODIFY gt_alv_zyc003 FROM gs_alv_zyc003.<br>        rs_selfield-refresh = &#x27;X&#x27;.<br>        CLEAR gs_alv_zyc003.<br>      ENDLOOP.<br>    WHEN &#x27;&amp;FSEA&#x27;.<br>      LOOP AT gt_alv_zyc003 INTO gs_alv_zyc003.<br>        CLEAR gs_alv_zyc003-slect.<br>        MODIFY gt_alv_zyc003 FROM gs_alv_zyc003.<br>        rs_selfield-refresh = &#x27;X&#x27;.<br>        CLEAR gs_alv_zyc003.<br>      ENDLOOP.<br>     WHEN &#x27;&amp;REMOVE&#x27;.<br>        CLEAR lt_zyc003.<br>        CLEAR ls_zyc003.<br>        LOOP AT gt_alv_zyc003 INTO gs_alv_zyc003 WHERE slect = &#x27;X&#x27;.<br>          ls_zyc003-ebeln = gs_alv_zyc003-ebeln.<br>          ls_zyc003-bukrs = gs_alv_zyc003-bukrs.<br>          ls_zyc003-bsart = gs_alv_zyc003-bsart.<br>          ls_zyc003-lifnr = gs_alv_zyc003-lifnr.<br>          ls_zyc003-zterm = gs_alv_zyc003-zterm.<br>          APPEND ls_zyc003 TO lt_zyc003.<br>        ENDLOOP.<br>        DELETE gt_alv_zyc003 WHERE slect = &#x27;X&#x27;.<br>        DELETE zyc003 FROM TABLE lt_zyc003.<br>        COMMIT WORK.<br>        rs_selfield-refresh = &#x27;X&#x27;.<br>    ENDCASE.<br>ENDFORM.<br></code></pre></td></tr></table></figure><h2 id="DATACHANGED事件"><a href="#DATACHANGED事件" class="headerlink" title="DATACHANGED事件"></a>DATACHANGED事件</h2><blockquote><p>需要将<code>data_changed</code>配置到EVENT参数中：</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">gs_event-name = gs_event-form = &#x27;DATA_CHANGED&#x27;.<br>APPEND gs_event TO gt_event.<br></code></pre></td></tr></table></figure><p>代码示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">FORM data_changed USING pcl_data TYPE REF TO cl_alv_changed_data_protocol.<br>  data: lt_mod_cell TYPE lvc_t_modi,<br>        ls_mod_cell TYPE lvc_s_modi.<br>  lt_mod_cell = pcl_data-&gt;mt_mod_cells.<br>  LOOP AT lt_mod_cell INTO ls_mod_cell WHERE fieldname = &#x27;lifnr&#x27;. &quot; 如果有多个列需要响应，可以去掉此处的where在循环中使用case或if判断即可<br>    READ TABLE gt_alv_zyc003 INTO gs_alv_zyc003 INDEX ls_mod_cell-row_id.&quot; 读内表中将要被修改的一行<br>      gs_alv_zyc003-lifnr = ls_mod_cell-value. &quot; ALV界面已经改了，现在把这个修改内容赋值给内表工作区<br>      IF ls_mod_cell-value = &#x27;002&#x27;.<br>        gs_alv_zyc003-rcolr = &#x27;C610&#x27;.<br>        MODIFY gt_alv_zyc003 FROM gs_alv_zyc003 INDEX ls_mod_cell-row_id . &quot;更新内表<br>      ELSE.<br>        gs_alv_zyc003-rcolr = &#x27;&#x27;.<br>        MODIFY gt_alv_zyc003 FROM gs_alv_zyc003 INDEX ls_mod_cell-row_id . &quot;更新内表<br>      ENDIF.<br>      CLEAR gs_alv_zyc003.<br>      PERFORM re_alv.<br>  ENDLOOP.<br></code></pre></td></tr></table></figure><h2 id="颜色更改"><a href="#颜色更改" class="headerlink" title="颜色更改"></a>颜色更改</h2><p>颜色设置中有优先级顺序，他们是单元格–&gt;行–&gt;列，即若同时使用了上述3中更改颜色的方法，则列的颜色会被行的颜色覆盖掉，而行的颜色又会被单元格的颜色覆盖掉，最终只会显示出单元格的颜色。</p><p>如果这列被设置为关键列，就是LS_FCAT-KEY &#x3D; ‘X’ ，那么颜色设置就不会起作用</p><h3 id="行颜色"><a href="#行颜色" class="headerlink" title="行颜色"></a>行颜色</h3><p>ALV中的每行数据颜色是通过LAYOUT来控制的。需要在显示输出内表结构中增加一列字段，用来存储数据行的颜色</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">TYPE-POOLS:slis.<br>DATA: gt_fieldcat TYPE slis_t_fieldcat_alv WITH HEADER LINE.<br>DATA: gs_layout TYPE slis_layout_alv.<br><br>DATA:BEGIN OF gt_data OCCURS 0,<br> val1(4),&quot;颜色值<br> val2(4),&quot;颜色值<br> color(4),&quot;用来存储行颜色<br> END OF gt_data.<br><br>START-OF-SELECTION.<br> PERFORM inital.<br> DEFINE fill_fdcat.<br>  clear gt_fieldcat.<br>  gt_fieldcat-fieldname = &amp;1.<br>  gt_fieldcat-seltext_l = &amp;2.<br>  append gt_fieldcat.<br> END-OF-DEFINITION.<br><br> fill_fdcat &#x27;VAL1&#x27; &#x27;颜色值&#x27;.<br> fill_fdcat &#x27;VAL2&#x27; &#x27;颜色值&#x27;.<br><br> gs_layout-info_fieldname = &#x27;COLOR&#x27;.&quot; 指定哪一列用来作为行颜色的列<br> CALL FUNCTION &#x27;REUSE_ALV_GRID_DISPLAY&#x27;<br>  EXPORTING<br>   it_fieldcat = gt_fieldcat[]<br>   is_layout  = gs_layout<br>  TABLES<br>   t_outtab  = gt_data.<br><br>FORM inital .<br> DATA: c1,c2,c3.<br> DO 8 TIMES.<br>  c1 = sy-index - 1.<br>  DO 2 TIMES.<br>   c2 = sy-index - 1.<br>   DO 2 TIMES.<br>    c3 = sy-index - 1.<br>    CONCATENATE &#x27;C&#x27; c1 c2 c3 INTO gt_data-color.<br>    gt_data-val1 = gt_data-color.<br>    gt_data-val2 = gt_data-color.<br>    APPEND gt_data.<br>   ENDDO.<br>  ENDDO.<br> ENDDO.<br>ENDFORM.<br></code></pre></td></tr></table></figure><ul><li>颜色值定义为4位字符，首位固定为字母“C”</li><li>第2位为颜色，由0~7表示，不同的数字表示不同的颜色属性</li><li>第3位表示输出文字是否高亮显示，由0~1表示，为1时表示高亮显示</li><li>第4位测试了一下，基本上0~9颜色都差不多，唯一就是当取值为1时，底色又回到了灰色（且只是在第3位为0时才有此效果）</li></ul><table><thead><tr><th>第一位（固定为C）</th><th>第二位</th><th>第三位</th><th>第四位</th><th>代表颜色</th></tr></thead><tbody><tr><td>C</td><td>0</td><td>0</td><td>0</td><td>background color</td></tr><tr><td>C</td><td>1</td><td>0</td><td>0</td><td>Gray-blue</td></tr><tr><td>C</td><td>2</td><td>0</td><td>0</td><td>Light gray</td></tr><tr><td>C</td><td>3</td><td>0</td><td>0</td><td>yellow</td></tr><tr><td>C</td><td>4</td><td>0</td><td>0</td><td>blue-gray</td></tr><tr><td>C</td><td>5</td><td>0</td><td>0</td><td>green</td></tr><tr><td>C</td><td>6</td><td>0</td><td>0</td><td>red</td></tr><tr><td>C</td><td>7</td><td>0</td><td>0</td><td>orange</td></tr></tbody></table><blockquote><p>ALV中的颜色是由4位数组成：’C’+COL+INT+INV</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">types: begin of slis_color,<br>     col type i,<br>     int type i,<br>     inv type i,<br>    end of slis_color.<br></code></pre></td></tr></table></figure><ul><li>第1位：固定取值为C</li><li>第2位COL：颜色值，取值为0~7</li><li>第3位INT：高亮，即颜色是否加深，取值为0、1。1表示加深显示</li><li>第4位INV：颜色是否反转，即颜色是作用在背景上，还是作用在输出字符上，取值上为0、1。为1时表示设置的是前景色，即输出字符本身的颜色（好像只有在第3位为0时才有效？）</li></ul><p>颜色参考表如下：</p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730172603207.png" alt="image-20230730172603207"></p><p><img src="https://cdn.jsdelivr.net/gh/Yan-Cam/blogPictureHost/image-20230730172642005.png" alt="image-20230730172642005"></p><h3 id="列颜色"><a href="#列颜色" class="headerlink" title="列颜色"></a>列颜色</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">TYPE-POOLS:slis.<br>DATA: gt_fieldcat TYPE slis_t_fieldcat_alv WITH HEADER LINE.<br>DATA: gt_sort TYPE slis_t_sortinfo_alv WITH HEADER LINE.<br>DATA:BEGIN OF gt_data OCCURS 0,<br>  curr TYPE ekpo-netpr,<br>  int TYPE i,<br>  p TYPE p LENGTH 5 DECIMALS 2,<br>  END OF gt_data.<br><br>START-OF-SELECTION.<br>  PERFORM inital.<br>  DEFINE fill_fdcat.<br>    clear gt_fieldcat.<br>    gt_fieldcat-fieldname = &amp;1.<br>    gt_fieldcat-seltext_l = &amp;2.<br>    if &amp;1 = &#x27;CURR&#x27; .<br>      &quot;设置列颜色<br>      gt_fieldcat-emphasize = &#x27;C510&#x27;.<br>    endif.<br>    if &amp;1 = &#x27;INT&#x27; .<br>      gt_fieldcat-emphasize = &#x27;C610&#x27;.<br>    endif.<br>    append gt_fieldcat.<br>  END-OF-DEFINITION.<br><br>  fill_fdcat &#x27;CURR&#x27; &#x27;CURR&#x27; .<br>  fill_fdcat &#x27;INT&#x27; &#x27;INT&#x27; .<br>  fill_fdcat &#x27;P&#x27; &#x27;P(3.2)&#x27; .<br><br>  CALL FUNCTION &#x27;REUSE_ALV_GRID_DISPLAY&#x27;<br>    EXPORTING<br>      i_callback_program = sy-repid<br>      it_fieldcat        = gt_fieldcat[]<br>    TABLES<br>      t_outtab           = gt_data[].<br><br>FORM inital .<br>  gt_data-curr = 1.<br>  gt_data-int = 1.<br>  gt_data-p = 1.<br>  APPEND gt_data.<br>  gt_data-curr = 2.<br>  gt_data-int = 2.<br>  gt_data-p = 2.<br>  APPEND gt_data.<br>ENDFORM.<br></code></pre></td></tr></table></figure><h3 id="单元格颜色"><a href="#单元格颜色" class="headerlink" title="单元格颜色"></a>单元格颜色</h3><p><img src="https://images0.cnblogs.com/blog/717614/201502/141044024489045.png" alt="image029[6]"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">TYPE-POOLS:slis.<br>DATA: gt_fieldcat TYPE slis_t_fieldcat_alv WITH HEADER LINE.<br>DATA: gs_layout TYPE slis_layout_alv.<br><br>DATA:BEGIN OF gt_data OCCURS 0,<br>  val1(40),&quot;颜色值<br>  val2(40),&quot;颜色值<br>  val3(40),<br>  colortable TYPE slis_t_specialcol_alv, &quot;每行中的单元格颜色内表，可对多个单元格进行不同颜色设置<br>  END OF gt_data.<br>&quot;每行中单元格颜色列表<br>DATA: gt_color TYPE slis_t_specialcol_alv WITH HEADER LINE.<br><br>START-OF-SELECTION.<br>  PERFORM inital.<br>  DEFINE fill_fdcat.<br>    clear gt_fieldcat.<br>    gt_fieldcat-fieldname = &amp;1.<br>    gt_fieldcat-seltext_l = &amp;2.<br>    append gt_fieldcat.<br>  END-OF-DEFINITION.<br><br>  fill_fdcat &#x27;VAL1&#x27; &#x27;颜色值&#x27;.<br>  fill_fdcat &#x27;VAL2&#x27; &#x27;颜色值&#x27;.<br>  fill_fdcat &#x27;VAL3&#x27; &#x27;无颜色&#x27;.<br><br>  gs_layout-coltab_fieldname = &#x27;COLORTABLE&#x27;.&quot;设置输出内表中哪列为颜色列表<br><br>  CALL FUNCTION &#x27;REUSE_ALV_GRID_DISPLAY&#x27;<br>    EXPORTING<br>      it_fieldcat = gt_fieldcat[]<br>      is_layout   = gs_layout<br>    TABLES<br>      t_outtab    = gt_data.<br><br>FORM inital .<br>  DATA: c1,c2.<br>  DO 7 TIMES.<br>    c1 = gt_color-color-col = sy-index - 1.&quot;颜色值<br>    DO 2 TIMES.<br>      c2 = gt_color-color-int =  sy-index - 1.&quot;颜色亮度<br>      gt_color-color-inv = &#x27;0&#x27;.&quot;颜色作用于背景<br>      CASE sy-index .<br>        WHEN 1.<br>          gt_color-fieldname = &#x27;VAL1&#x27;.&quot;需进行颜色设置的列名（已具体到单元格）<br>          CONCATENATE &#x27;col=&#x27; c1 ` ` &#x27;int=&#x27; c2 ` `  &#x27;inv=0&#x27;  INTO gt_data-val1 .<br>        WHEN 2.<br>          gt_color-fieldname = &#x27;VAL2&#x27;.&quot;需进行颜色设置的列名（已具体到单元格）<br>          CONCATENATE &#x27;col=&#x27; c1 ` ` &#x27;int=&#x27; c2 ` `  &#x27;inv=0&#x27;  INTO gt_data-val2 .<br>      ENDCASE.<br>      APPEND gt_color.<br>    ENDDO.<br>    &quot;设置每行数据中单元格的颜色内表<br>    gt_data-colortable = gt_color[].<br>    gt_data-val3 = &#x27;无颜色&#x27;.<br>    APPEND gt_data.<br>    CLEAR:gt_color,gt_color[].<br>  ENDDO.<br></code></pre></td></tr></table></figure><h2 id="可编辑"><a href="#可编辑" class="headerlink" title="可编辑"></a>可编辑</h2><p>整体可编辑</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">DATA: gs_layout TYPE slis_layout_alv.<br>gs_layout-edit = &#x27;X&#x27;.<br></code></pre></td></tr></table></figure><p>列可编辑，设置fieldcat里的edit参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">gt_fieldcat-edit = &#x27;X&#x27;<br></code></pre></td></tr></table></figure><p>单元格满足条件可编辑，只能通过<code>REUSE_ALV_GRID_DISPLAY_LVC</code>来完成这一操作，具体思路是先设置该列可编辑，再控制不满足条件的样式为不可编辑样式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">&quot;TYPE-POOLS:slis.<br>DATA: gt_fieldcat TYPE lvc_t_fcat WITH HEADER LINE.&quot;注：此时的fieldcat不再引用slis_t_fieldcat_alv类型<br>DATA: gs_layout TYPE lvc_s_layo.&quot;注：此时的Layout不再是引用slis_layout_alv类型<br><br>DATA:BEGIN OF gt_data OCCURS 0,<br>  val1(40),<br>  val2(40),<br>  cellstab TYPE lvc_t_styl,&quot;单元格可编辑控制<br>  END OF gt_data.<br>&quot;单元格可编辑控制内表<br>DATA: gt_cellstab TYPE lvc_t_styl WITH HEADER LINE.<br><br>START-OF-SELECTION.<br>  PERFORM inital.<br>  DEFINE fill_fdcat.<br>    clear gt_fieldcat.<br>    gt_fieldcat-fieldname = &amp;1.<br>    gt_fieldcat-scrtext_l = &amp;2.<br>    &quot;设置单元格为可编辑状态：此处设置所有单元格都可编辑<br>    gt_fieldcat-edit = &#x27;X&#x27;.<br>    append gt_fieldcat.<br>  END-OF-DEFINITION.<br><br>  fill_fdcat &#x27;VAL1&#x27; &#x27;列1&#x27;.<br>  fill_fdcat &#x27;VAL2&#x27; &#x27;列2&#x27;.<br><br>  gs_layout-stylefname = &#x27;CELLSTAB&#x27;.&quot;设置可编辑信息<br>  CALL FUNCTION &#x27;REUSE_ALV_GRID_DISPLAY_LVC&#x27;<br>    EXPORTING<br>      is_layout_lvc   = gs_layout<br>      it_fieldcat_lvc = gt_fieldcat[]<br>    TABLES<br>     t_outtab        = gt_data.<br><br>FORM inital .<br>  gt_data-val1 = &#x27;cell1&#x27;.<br>  gt_data-val2 = &#x27;cell2&#x27;.<br>  gt_cellstab-fieldname = &#x27;VAL1&#x27;.<br>  &quot;将原本可编辑的单元格切换到不可编辑样式。注：这里<br>  &quot;只是样式的切换，不能仅仅使用cl_gui_alv_grid=&gt;mc_style_enabled来将单元格设置为<br>  &quot;可编辑状态，单元格真正是否可编辑是由fieldcat-edit或layout-edit来决定的，而仅<br>  &quot;设置为cl_gui_alv_grid=&gt;mc_style_enabled是不可编辑的<br>  gt_cellstab-style = cl_gui_alv_grid=&gt;mc_style_disabled.<br>  APPEND gt_cellstab.<br>  gt_data-cellstab = gt_cellstab[].<br>  APPEND gt_data.<br>ENDFORM.<br></code></pre></td></tr></table></figure><h2 id="整体示例代码"><a href="#整体示例代码" class="headerlink" title="整体示例代码"></a>整体示例代码</h2><p>此示例使用了 lvc alv 与 function alv 除了变量定义外别无区别。</p><p>ZYC_T004：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">*&amp;---------------------------------------------------------------------*<br>*&amp; Report ZYC_T004<br>*&amp;---------------------------------------------------------------------*<br>*&amp;<br>*&amp;---------------------------------------------------------------------*<br>REPORT ZYC_T004 MESSAGE-ID ZYC.<br>INCLUDE zyc_t004top.<br>INCLUDE zyc_t004form.<br>START-OF-SELECTION.<br>  PERFORM get_data.<br><br>END-OF-SELECTION.<br>  PERFORM display_data.<br><br>FORM display_data .<br>  IF gt_zyc003 IS NOT INITIAL.<br>    PERFORM build_fieldcat.                                 .<br>    PERFORM build_layout.<br>    PERFORM build_sort.<br>    PERFORM build_event.<br>    PERFORM build_alv.<br>  ELSE.<br>    MESSAGE i000.<br>  ENDIF.<br>ENDFORM.<br>*&amp;---------------------------------------------------------------------*<br>*&amp; Form build_fieldcat<br>*&amp;---------------------------------------------------------------------*<br>*&amp; text<br>*&amp;---------------------------------------------------------------------*<br>*&amp; --&gt;  p1        text<br>*&amp; &lt;--  p2        text<br>*&amp;---------------------------------------------------------------------*<br>FORM build_fieldcat .<br>  %%APPEND_FIELDCAT: &#x27;1&#x27; &#x27;ebeln&#x27; &#x27;10&#x27; &#x27;采购凭证编号&#x27; &#x27;&#x27; &#x27;&#x27; ,<br>                     &#x27;2&#x27; &#x27;bukrs&#x27; &#x27;10&#x27; &#x27;公司代码&#x27; &#x27;X&#x27; &#x27;&#x27; ,<br>                     &#x27;3&#x27; &#x27;bsart&#x27; &#x27;10&#x27; &#x27;采购凭证类型&#x27; &#x27;X&#x27; &#x27;&#x27; ,<br>                     &#x27;4&#x27; &#x27;lifnr&#x27; &#x27;10&#x27; &#x27;供应商账户号&#x27; &#x27;X&#x27; &#x27;&#x27; ,<br>                     &#x27;5&#x27; &#x27;zterm&#x27; &#x27;10&#x27; &#x27;付款条件代码&#x27; &#x27;X&#x27; &#x27;&#x27; ,<br>                     &#x27;6&#x27; &#x27;slect&#x27; &#x27;2&#x27; &#x27;选择&#x27; &#x27;X&#x27; &#x27;X&#x27; .<br>ENDFORM.<br>*&amp;---------------------------------------------------------------------*<br>*&amp; Form build_layout<br>*&amp;---------------------------------------------------------------------*<br>*&amp; text<br>*&amp;---------------------------------------------------------------------*<br>*&amp; --&gt;  p1        text<br>*&amp; &lt;--  p2        text<br>*&amp;---------------------------------------------------------------------*<br>FORM build_layout .<br>  LOOP AT gt_alv_zyc003 INTO gs_alv_zyc003.<br>    %%APPEND_FIELD_STYLE: &#x27;ebeln&#x27; cl_gui_alv_grid=&gt;mc_style_disabled,<br>                          &#x27;bukrs&#x27; cl_gui_alv_grid=&gt;mc_style_disabled,<br>                          &#x27;bsart&#x27; cl_gui_alv_grid=&gt;mc_style_disabled,<br>                          &#x27;lifnr&#x27; cl_gui_alv_grid=&gt;mc_style_disabled,<br>                          &#x27;zterm&#x27; cl_gui_alv_grid=&gt;mc_style_disabled.<br><br>    MODIFY gt_alv_zyc003 FROM gs_alv_zyc003.<br>  ENDLOOP.<br>    gs_grid_settings-edt_cll_cb  = &#x27;X&#x27; .<br>    gs_layout-info_fname = &#x27;rcolr&#x27;.<br>    gs_layout-stylefname = &#x27;field_style&#x27;.<br>ENDFORM.<br>*&amp;---------------------------------------------------------------------*<br>*&amp; Form build_sort<br>*&amp;---------------------------------------------------------------------*<br>*&amp; text<br>*&amp;---------------------------------------------------------------------*<br>*&amp; --&gt;  p1        text<br>*&amp; &lt;--  p2        text<br>*&amp;---------------------------------------------------------------------*<br>FORM build_sort .<br><br>ENDFORM.<br>*&amp;---------------------------------------------------------------------*<br>*&amp; Form build_event<br>*&amp;---------------------------------------------------------------------*<br>*&amp; text<br>*&amp;---------------------------------------------------------------------*<br>*&amp; --&gt;  p1        text<br>*&amp; &lt;--  p2        text<br>*&amp;---------------------------------------------------------------------*<br>FORM build_event .<br>  gs_event-name = gs_event-form = &#x27;DATA_CHANGED&#x27;.<br>  APPEND gs_event TO gt_event.<br>ENDFORM.<br>*&amp;---------------------------------------------------------------------*<br>*&amp; Form build_alv<br>*&amp;---------------------------------------------------------------------*<br>*&amp; text<br>*&amp;---------------------------------------------------------------------*<br>*&amp; --&gt;  p1        text<br>*&amp; &lt;--  p2        text<br>*&amp;---------------------------------------------------------------------*<br>FORM build_alv .<br>  CALL FUNCTION &#x27;REUSE_ALV_GRID_DISPLAY_LVC&#x27;<br>   EXPORTING<br>*     I_INTERFACE_CHECK                 = &#x27; &#x27;<br>*     I_BYPASSING_BUFFER                =<br>*     I_BUFFER_ACTIVE                   =<br>     I_CALLBACK_PROGRAM                = SY-REPID<br>     I_CALLBACK_PF_STATUS_SET          = &#x27;ALV_STATUS_SET&#x27;<br>     I_CALLBACK_USER_COMMAND           = &#x27;FRM_USER_COMMAND&#x27;<br>*     I_CALLBACK_TOP_OF_PAGE            = &#x27;&#x27;<br>     I_CALLBACK_HTML_TOP_OF_PAGE       = &#x27;HTML_TOP_OF_PAGE&#x27;<br>*     I_CALLBACK_HTML_END_OF_LIST       = &#x27; &#x27;<br>*     I_STRUCTURE_NAME                  = &#x27;&#x27;<br>*     I_BACKGROUND_ID                   = &#x27; &#x27;<br>*     I_GRID_TITLE                      =<br>     I_GRID_SETTINGS                   = gs_grid_settings<br>     IS_LAYOUT_LVC                     = gs_layout<br>     IT_FIELDCAT_LVC                   = gt_fieldcat<br>*     IT_EXCLUDING                      =<br>*     IT_SPECIAL_GROUPS_LVC             =<br>*     IT_SORT_LVC                       =<br>*     IT_FILTER_LVC                     =<br>*     IT_HYPERLINK                      =<br>*     IS_SEL_HIDE                       =<br>*     I_DEFAULT                         = &#x27;X&#x27;<br>*     I_SAVE                            = &#x27; &#x27;<br>*     IS_VARIANT                        =<br>     IT_EVENTS                         = gt_event<br>*     IT_EVENT_EXIT                     =<br>*     IS_PRINT_LVC                      =<br>*     IS_REPREP_ID_LVC                  =<br>*     I_SCREEN_START_COLUMN             = 0<br>*     I_SCREEN_START_LINE               = 0<br>*     I_SCREEN_END_COLUMN               = 0<br>*     I_SCREEN_END_LINE                 = 0<br>*     I_HTML_HEIGHT_TOP                 =<br>*     I_HTML_HEIGHT_END                 =<br>*     IT_ALV_GRAPHICS                   =<br>*     IT_EXCEPT_QINFO_LVC               =<br>*     IR_SALV_FULLSCREEN_ADAPTER        =<br>*   IMPORTING<br>*     E_EXIT_CAUSED_BY_CALLER           =<br>*     ES_EXIT_CAUSED_BY_USER            =<br>    TABLES<br>      t_outtab                          = gt_alv_zyc003<br>*   EXCEPTIONS<br>*     PROGRAM_ERROR                     = 1<br>*     OTHERS                            = 2<br>            .<br>  IF sy-subrc &lt;&gt; 0.<br>*   Implement suitable error handling here<br>  ENDIF.<br><br>ENDFORM.<br>*&amp;---------------------------------------------------------------------*<br>*&amp; Form get_data<br>*&amp;---------------------------------------------------------------------*<br>*&amp; text<br>*&amp;---------------------------------------------------------------------*<br>*&amp; --&gt;  p1        text<br>*&amp; &lt;--  p2        text<br>*&amp;---------------------------------------------------------------------*<br>FORM get_data .<br>  SELECT *<br>    FROM<br>    ZYC003<br>    WHERE EBELN IN @s_ebeln<br>    AND BUKRS = @p_bukrs<br>    AND BSART = @p_bsart<br>    INTO TABLE @gt_zyc003.<br>  LOOP AT gt_zyc003 INTO gs_zyc003.<br>   MOVE: gs_zyc003-ebeln TO gs_alv_zyc003-ebeln,<br>         gs_zyc003-bukrs TO gs_alv_zyc003-bukrs,<br>         gs_zyc003-bsart TO gs_alv_zyc003-bsart,<br>         gs_zyc003-lifnr TO gs_alv_zyc003-lifnr,<br>         gs_zyc003-zterm TO gs_alv_zyc003-zterm.<br>   APPEND gs_alv_zyc003 TO gt_alv_zyc003.<br>   CLEAR gs_zyc003.<br>  ENDLOOP.<br>ENDFORM.<br><br>FORM FRM_USER_COMMAND USING R_UCOMM LIKE SY-UCOMM RS_SELFIELD TYPE SLIS_SELFIELD.<br>  DATA: l_grid TYPE REF TO cl_gui_alv_grid,<br>        lt_zyc003 TYPE STANDARD TABLE OF zyc003,<br>        ls_zyc003 LIKE LINE OF lt_zyc003.<br>  CASE R_UCOMM.<br>    WHEN &#x27;&amp;ADD&#x27;.<br>        DATA: lines TYPE i.<br>        CLEAR gs_zyc003.<br>        CLEAR gt_zyc003.<br>        INSERT INITIAL LINE INTO gt_alv_zyc003 INDEX 1.<br>        INSERT INITIAL LINE INTO gt_zyc003 INDEX 1.<br>        IF sy-subrc = 0.<br>           READ TABLE gt_alv_zyc003 INTO gs_alv_zyc003 INDEX 1.<br>           CLEAR gs_alv_zyc003-field_style.<br>           lines = LINES( gt_alv_zyc003 ) + 1.<br>           gs_alv_zyc003-ebeln = lines.<br>           gs_zyc003-ebeln = lines.<br>           MODIFY gt_alv_zyc003 FROM gs_alv_zyc003 INDEX 1.<br>           MODIFY gt_zyc003 FROM gs_zyc003 INDEX 1.<br>           INSERT zyc003 FROM TABLE gt_zyc003.<br>           COMMIT WORK.<br>           CLEAR gs_zyc003.<br>           CLEAR gt_zyc003.<br>           CLEAR gs_alv_zyc003.<br>        ENDIF.<br>        RS_SELFIELD-refresh = &#x27;X&#x27;.<br>    WHEN &#x27;&amp;ZSAVE&#x27;.<br>       CLEAR lt_zyc003.<br>       CLEAR ls_zyc003.<br>*------------将ALV上修改的内容保存到内表---------------------------------*<br>      CALL FUNCTION &#x27;GET_GLOBALS_FROM_SLVC_FULLSCR&#x27;<br>        IMPORTING<br>          e_grid = l_grid.<br>      CALL METHOD l_grid-&gt;check_changed_data.<br>      LOOP AT gt_alv_zyc003 INTO gs_alv_zyc003 WHERE slect = &#x27;X&#x27;.<br>        ls_zyc003-ebeln = gs_alv_zyc003-ebeln.<br>        ls_zyc003-bukrs = gs_alv_zyc003-bukrs.<br>        ls_zyc003-bsart = gs_alv_zyc003-bsart.<br>        ls_zyc003-lifnr = gs_alv_zyc003-lifnr.<br>        ls_zyc003-zterm = gs_alv_zyc003-zterm.<br>        APPEND ls_zyc003 TO lt_zyc003.<br>      ENDLOOP.<br>      UPDATE zyc003 FROM TABLE lt_zyc003.<br>      commit WORK.<br>      rs_selfield-refresh = &#x27;X&#x27;.  &quot;自动刷新<br><br>    WHEN &#x27;&amp;EDIT&#x27;.<br>      LOOP AT gt_alv_zyc003 INTO gs_alv_zyc003.<br>        IF gs_alv_zyc003-slect = &#x27;X&#x27;.<br>            CLEAR gs_alv_zyc003-field_style.<br>            MODIFY gt_alv_zyc003 FROM gs_alv_zyc003.<br>            rs_selfield-refresh = &#x27;X&#x27;.<br>        ENDIF.<br>        CLEAR gs_alv_zyc003.<br>      ENDLOOP.<br>    WHEN &#x27;&amp;SEA&#x27;.<br>      LOOP AT gt_alv_zyc003 INTO gs_alv_zyc003.<br>        gs_alv_zyc003-slect = &#x27;X&#x27;.<br>        MODIFY gt_alv_zyc003 FROM gs_alv_zyc003.<br>        rs_selfield-refresh = &#x27;X&#x27;.<br>        CLEAR gs_alv_zyc003.<br>      ENDLOOP.<br>    WHEN &#x27;&amp;FSEA&#x27;.<br>      LOOP AT gt_alv_zyc003 INTO gs_alv_zyc003.<br>        CLEAR gs_alv_zyc003-slect.<br>        MODIFY gt_alv_zyc003 FROM gs_alv_zyc003.<br>        rs_selfield-refresh = &#x27;X&#x27;.<br>        CLEAR gs_alv_zyc003.<br>      ENDLOOP.<br>     WHEN &#x27;&amp;REMOVE&#x27;.<br>        CLEAR lt_zyc003.<br>        CLEAR ls_zyc003.<br>        LOOP AT gt_alv_zyc003 INTO gs_alv_zyc003 WHERE slect = &#x27;X&#x27;.<br>          ls_zyc003-ebeln = gs_alv_zyc003-ebeln.<br>          ls_zyc003-bukrs = gs_alv_zyc003-bukrs.<br>          ls_zyc003-bsart = gs_alv_zyc003-bsart.<br>          ls_zyc003-lifnr = gs_alv_zyc003-lifnr.<br>          ls_zyc003-zterm = gs_alv_zyc003-zterm.<br>          APPEND ls_zyc003 TO lt_zyc003.<br>        ENDLOOP.<br>        DELETE gt_alv_zyc003 WHERE slect = &#x27;X&#x27;.<br>        DELETE zyc003 FROM TABLE lt_zyc003.<br>        COMMIT WORK.<br>        rs_selfield-refresh = &#x27;X&#x27;.<br>    ENDCASE.<br>ENDFORM.<br><br>FORM alv_status_set USING rT_EXTAB TYPE SLIS_T_EXTAB.<br>    SET PF-STATUS &#x27;ZUI&#x27;.<br>ENDFORM.<br><br>FORM data_changed USING pcl_data TYPE REF TO cl_alv_changed_data_protocol.<br>  data: lt_mod_cell TYPE lvc_t_modi,<br>        ls_mod_cell TYPE lvc_s_modi.<br>  lt_mod_cell = pcl_data-&gt;mt_mod_cells.<br>  LOOP AT lt_mod_cell INTO ls_mod_cell WHERE fieldname = &#x27;lifnr&#x27;.<br>    READ TABLE gt_alv_zyc003 INTO gs_alv_zyc003 INDEX ls_mod_cell-row_id.&quot; 读内表中将要被修改的一行<br>      gs_alv_zyc003-lifnr = ls_mod_cell-value. &quot; ALV界面已经改了，现在把这个修改内容赋值给内表工作区<br>      IF ls_mod_cell-value = &#x27;002&#x27;.<br>        gs_alv_zyc003-rcolr = &#x27;C610&#x27;.<br>        MODIFY gt_alv_zyc003 FROM gs_alv_zyc003 INDEX ls_mod_cell-row_id . &quot;更新内表<br>      ELSE.<br>        gs_alv_zyc003-rcolr = &#x27;&#x27;.<br>        MODIFY gt_alv_zyc003 FROM gs_alv_zyc003 INDEX ls_mod_cell-row_id . &quot;更新内表<br>      ENDIF.<br>      CLEAR gs_alv_zyc003.<br>      PERFORM re_alv.<br>  ENDLOOP.<br><br>ENDFORM.<br><br>FORM re_alv.<br>  DATA:lv_grid  TYPE REF TO CL_GUI_ALV_GRID,<br>       ls_layout TYPE LVC_S_LAYO.&quot;这一句很关键<br>  CALL FUNCTION &#x27;GET_GLOBALS_FROM_SLVC_FULLSCR&#x27;<br>    IMPORTING<br>      E_GRID = lv_grid.<br>* 获取ALV变化过后的布局参数<br>  CALL METHOD LV_GRID-&gt;GET_FRONTEND_LAYOUT<br>    IMPORTING<br>      ES_LAYOUT = ls_layout.<br><br>* 重新回写自适应宽度<br><br>   gs_layout-info_fname = &#x27;rcolr&#x27;.<br><br>* 回写ALV变化过后的布局参数<br>  CALL METHOD LV_GRID-&gt;SET_FRONTEND_LAYOUT<br>    EXPORTING<br>      IS_LAYOUT = ls_layout.<br><br>* 刷新ALV布局<br>  CALL METHOD LV_GRID-&gt;REFRESH_TABLE_DISPLAY.<br>ENDFORM.<br><br>FORM html_top_of_page USING DOCUMENT TYPE REF TO CL_DD_DOCUMENT.<br>     DATA : m_p TYPE I ,<br>            m_buffer TYPE STRING.<br>     CONCATENATE &#x27;&lt;html&gt;&lt;center&gt;&lt;h1&gt;&#x27;<br>                  &#x27;考核程序&#x27;<br>                  &#x27;&lt;/h1&gt;&lt;/center&gt;&lt;/html&gt;&#x27;<br>                  INTO  m_buffer.<br>     CALL  METHOD DOCUMENT-&gt;HTML_INSERT   &quot;使用html insert css布局保证了 标题永远居中<br>     EXPORTING<br>      CONTENTS = m_buffer<br>     CHANGING<br>       POSITION = M_P.<br>ENDFORM.<br></code></pre></td></tr></table></figure><p>zyc_t004top：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">*&amp;---------------------------------------------------------------------*<br>*&amp; 包含               ZYC_T004TOP<br>*&amp;---------------------------------------------------------------------*<br><br>DATA: gt_zyc003 TYPE STANDARD TABLE OF ZYC003,<br>      gs_zyc003 LIKE LINE OF gt_zyc003,<br>      gt_fieldcat TYPE lvc_t_fcat,<br>      gs_fieldcat TYPE lvc_s_fcat.<br><br>TYPES: BEGIN OF gty_alv_zyc003.<br>       INCLUDE STRUCTURE gs_zyc003.<br>TYPES: slect TYPE C,<br>       rcolr TYPE CHAR4,<br>       field_style TYPE LVC_T_STYL,<br>       END OF gty_alv_zyc003.<br><br>DATA: gt_alv_zyc003 TYPE STANDARD TABLE OF gty_alv_zyc003,<br>      gs_alv_zyc003 LIKE LINE OF gt_alv_zyc003,<br>      gs_field_style TYPE LVC_S_STYL,<br>      gs_layout TYPE lvc_S_layo,<br>      gt_event TYPE SLIS_T_EVENT,<br>      gs_event TYPE SLIS_ALV_EVENT,<br>      gs_grid_settings TYPE lvc_s_glay.<br><br>DEFINE %%APPEND_FIELDCAT.<br>  CLEAR gs_fieldcat.<br>  gs_fieldcat-col_pos = &amp;1.<br>  gs_fieldcat-fieldname = &amp;2.<br>  gs_fieldcat-outputlen = &amp;3.<br>  gs_fieldcat-scrtext_m = &amp;4.<br>  gs_fieldcat-edit = &amp;5.<br>  gs_fieldcat-checkbox = &amp;6.<br>  APPEND gs_fieldcat TO gt_fieldcat.<br>END-OF-DEFINITION.<br><br>DEFINE %%APPEND_FIELD_STYLE.<br>  CLEAR gs_field_style.<br>  gs_field_style-fieldname = &amp;1.<br>  gs_field_style-style = &amp;2.<br>  INSERT gs_field_style INTO TABLE gs_alv_zyc003-field_style.<br>END-OF-DEFINITION.<br></code></pre></td></tr></table></figure><p>zyc_t004form：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ABAP">*&amp;---------------------------------------------------------------------*<br>*&amp; 包含               ZYC_T004FORM<br>*&amp;---------------------------------------------------------------------*<br>SELECT-OPTIONS s_ebeln FOR gs_zyc003-EBELN.<br>PARAMETERS p_bukrs LIKE EKKO-BUKRS.<br>PARAMETERS p_bsart LIKE EKKO-BSART.<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ABAP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SAP</tag>
      
      <tag>ABAP</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
